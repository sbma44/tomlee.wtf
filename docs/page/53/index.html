<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Tom Lee</title>


    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Domine:wght@400;600;700&family=Josefin+Sans:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Theme CSS -->
    <link rel="stylesheet" href="/theme/css/style.css">

    <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Tom Lee Atom Feed" />

</head>

<body>
    <header id="typology-header" class="typology-header">
        <div class="container">
            <div class="header-content">
                <div class="site-branding">
                    <h1 class="site-title"><a href="/">Tom Lee</a></h1>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li><a href="/">Home</a></li>
                        <li><a href="/about/">About</a></li>
                        <li><a href="/projects/">Projects</a></li>
                        <li class="social-icon"><a href="https://github.com/sbma44" target="_blank" rel="noopener" title="GitHub" aria-label="GitHub">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                        </a></li>
                        <li class="social-icon"><a href="https://x.com/tjl" target="_blank" rel="noopener" title="Twitter" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg>
                        </a></li>
                        <li class="social-icon"><a href="https://bsky.app/profile/tjl.bsky.social" target="_blank" rel="noopener" title="Bluesky" aria-label="Bluesky">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"/></svg>
                        </a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <div class="typology-fake-bg">
<div class="typology-section">

    <div class="section-content">
        <div class="typology-posts">
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/14/everythings-terrible/">everything's terrible</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-14T13:01:00-05:00">Wednesday, 14 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">E</div>
                </header>

                <div class="entry-content">
                    <p>Man, what a lousy start to the morning. To be fair, any morning that starts at 2:30 is probably going to be fairly crappy, but this one has some real staying power. I was awakened by a tap-tap-tapping on my chamber door. The last time this happened it was a cop who wanted to explain that he'd chased a suspect into my garage. Based on that experience it seemed like it was worth getting up. This time it was just my neighbor, who swept into the apartment and started fiddling with our thermostat. Apparently something in the building was vibrating annoyingly, and, as irresponsible young renters, Charles and I seemed like the sort of people who might ignore a problem until it involved shrapnel and scalding.</p>
<p>But it turned out that it wasn't our furnace at all — it was blowing its usual stream of frigid air throughout the nighttime apartment as reliably as ever. This happens every time it snows — the heat pump can't produce air hot enough to meet our modest-yet-optimistic thermostat setting, so the system just tries blowing the cold air <em>faster</em> in order to make up the difference. I appreciate the effort, but it's not much help.</p>
<p>The other annoyances have been more minor. There was the slog to work through unsalted sidewalks — well, except for the American Chemical Association's stretch of pavement, which is always immaculately clear (but also seems likely to be highly carcinogenic). And LastCall is <a class="reference external" href="http://www.dcist.com/archives/2007/02/14/lastcall_needs.php">throwing a fit</a>, requiring me to shut it down until I can locate a nasty bug and quash it.</p>
<p>But the biggest letdown is that our company sexual harassment training — which, yes, was scheduled for Valentine's Day — has been rescheduled due to the winter weather. I'm pretty bummed out; I had gone to a lot of effort separating candy hearts into &quot;workplace-safe&quot; and &quot;unacceptably sexual&quot; piles.</p>
<div class="line-block">
<div class="line"><a class="reference external image-reference" href="http://www.flickr.com/photos/sbma44/390331941/"><img alt="valentine's candy hearts sorted into 'acceptable' and 'unacceptable' piles" class="center" src="http://farm1.static.flickr.com/157/390331941_9bd013673c.jpg" style="width: 500px; height: 375px;" /></a></div>
<div class="line"><a class="reference external image-reference" href="http://www.flickr.com/photos/sbma44/390331784/"><img alt="the aforementioned hearts separated into ziploc bags" class="center" src="http://farm1.static.flickr.com/176/390331784_582bb7e354.jpg" style="width: 500px; height: 375px;" /></a></div>
</div>
<p>Some of these were judgment calls: &quot;my boy&quot; was on the line, but its assertion of possession (and racist undertones) ultimately led me to give it the axe. Similarly, &quot;dare ya&quot; seemed fairly non-sexual, but was discarded due to the high odds that it would set events in motion that could lead to worker's comp claims. But most of the objectionable hearts were easy to spot. &quot;Kiss me&quot;? &quot;So fine&quot;? You'd be astounded at the filth that Brach's gets away with.</p>
<p>As for the rest of the day... well, I'm not optimistic. The high availability of candy hearts in my workplace makes it likely that I'm going to be feeling very sick by the time I head home.</p>
<p><strong>UPDATE:</strong> The stupid cafe around the corner forgot to put stupid dolmadas in my stupid carryout Greek salad. I hate this universe.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/14/you-know-a-band-is-hot/">you know a band is hot</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-14T11:27:00-05:00">Wednesday, 14 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">Y</div>
                </header>

                <div class="entry-content">
                    <p>...when it's making its way into email spam. Forget <a class="reference external" href="http://www.google.com/press/zeitgeist.html">Google</a> — this is the real measure of the online zeitgeist.</p>
<p><img alt="screengrab of my inbox, featuring a spam message sent by 'the arcade fire'" class="center" src="/static/2007/02/14/20070214_arcadefire.gif" style="width: 494px; height: 112px;" /></p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/13/did-everybody-wash-their-necks-like-mr-burns-asked/">did everybody wash their necks like Mr. Burns asked?</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-13T10:51:00-05:00">Tuesday, 13 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">D</div>
                </header>

                <div class="entry-content">
                    <p>On the way into work this morning I saw a large, gaily-decorated RV with nurses inside of it. It was, of course, a blood donation van — a bloodmobile. More specifically, it was the Children's Bloodmobile:</p>
<p><img alt="image1" class="center" src="/static/2007/02/13/20070213_bloodmobile.jpg" style="width: 250px; height: 212px;" /></p>
<p>I had always assumed that the &quot;Children's&quot; in the title stood for <a class="reference external" href="http://www.dcchildrens.com/">Children's Hospital</a>. But if that's the case, is it just coincidence that the bloodmobile was parked outside of <a class="reference external" href="http://www.sailpcs.org/">a K-12 charter school</a>?</p>
<p><a class="reference external image-reference" href="http://www.flickr.com/photos/sbma44/389193999/"><img alt="photo of a children's bloodmobile parked directly outside of a charter school" class="center" src="http://farm1.static.flickr.com/148/389193999_a027008220.jpg" /></a></p>
<p>Is that &quot;children's&quot; a proper noun or an adjective? It might be time to read up on how charter schools get their funding.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/12/music-things/">music things</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-12T12:16:00-05:00">Monday, 12 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">M</div>
                </header>

                <div class="entry-content">
                    <p>I watched some of the Grammies last night, but I think I repressed everything that happened after the Eagles tribute. So it comes as an unpleasant shock to hear <a class="reference external" href="http://blogstretch.blogspot.com/2007/02/beginning-and-end.html">from Amanda</a> that &quot;My Humps&quot; won an award last night. I can't say that I ever expected to feel indignant sympathy for the Pussycast Dolls, but <a class="reference external" href="http://en.wikipedia.org/wiki/Nominees_for_Grammy_Awards_of_2007#Best_Pop_Performance_by_a_Duo_or_Group_with_Vocal">there it is</a>.</p>
<p>I know, I know. It's the Grammies. It's supposed to be arbitrary and stupid. Still, there's something that's off-putting about an entity of pure evil receiving official recognition, no matter how dubious the honor. What if <em>Mein Kampf</em> was selected for Oprah's Book Club? That wouldn't sit right with you, would it?</p>
<p>And so it is with &quot;My Humps&quot;. I'm trying to think of what sort of song I would have preferred to see the Best Pop Song Grammy go to instead, and I'm having a hard time coming up with one that doesn't qualify. Maybe an hours-long recording of a girl scout troop's pathetic sobs as its members are forced to euthanize hundreds of baby animals with rubber mallets? It's hard to say. Are we talking about farm animals or pet animals? I guess that's where the line falls for me.</p>
<p><center><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
</center></p><p>On to Arcade Fire-related matters. TUL is, as usual, <a class="reference external" href="http://theupstatelife.blogspot.com/2007/02/arcade-fire-to-play-constitution-hall.html">on top of the concert situation in DC</a> (as is <a class="reference external" href="http://dccharles.blogspot.com">Charles</a>, from whom I first heard this rumor last night). But the news he brings is not good: word is that The Arcade Fire are coming to town, but they'll be setting up shop in DAR.</p>
<p>I really hope this is wrong. DAR is for old people. There are seats and risers and carpeted floors. I'm sure it'd be a lovely spot for Glenn Miller show, but it's a miserable venue for a rock concert. I realize that two nights at 9:30 is a lot to ask from a band that's as hot a ticket as TAF, but I'd honestly rather have the band play out at George Mason than at DAR.</p>
<p>Oh well. At least the album is good. I was prepared to be disappointed after hearing the three leaked tracks that I grabbed before a friend sent me the full thing. &quot;Black Mirror&quot;, &quot;Black Wave&quot; and &quot;Intervention&quot; were all okay, but they didn't affect me in the way that <em>Funeral</em> did. Fortunately, the second half of the album seems much, much better to me. &quot;Ocean of Noise&quot;, &quot;The Well and the Lighthouse&quot;, &quot;(Antichrist Television Blues)&quot;, &quot;Windowsill&quot; and &quot;No Cars Go&quot; comprise a solid block of music that I can't stop listening to.</p>
<p>&quot;No Cars Go&quot; is a particularly pleasant surprise — I hadn't paid attention to the <em>Neon Bible</em> tracklists, so the inclusion of the track caught me off-guard. They've been playing the song for a long time (it was on their first album) but until now I haven't been able to find a good recording. The first studio version wasn't performed or produced very well, and a series of muddy live recordings didn't satisfy, either.</p>
<p>But now we've got a real version, and it's unbelievably huge, overwhelming and, frankly, kind of exhausting to listen to. But it's still great, because it reminds you that during the live show it'll be <em>even bigger</em>. It'll be the biggest thing you've ever heard.</p>
<p><strong>UPDATE:</strong> <a class="reference external" href="http://www.pitchforkmedia.com/article/news/41118">Yup, DAR</a>. Hell. Well, maybe I can catch the Philly show.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/11/its-kind-of-like-a-spanish-vampire/">it's kind of like a spanish vampire</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-11T21:18:00-05:00">Sunday, 11 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">I</div>
                </header>

                <div class="entry-content">
                    <p>It's true that I'm not much of an expert in these matters. Still, I feel confident in saying that the announcer's allegedly-Mexican accent in this Taco Bell commercial is astoundingly fake:</p>
<p><center><object width="425" height="350"><embed src="http://www.youtube.com/v/Yd9aj7X5f1Y" type="application/x-shockwave-flash" wmode="transparent" width="425" height="350"></embed></object></center></p><p>Maybe I'm wrong, but it seems pretty inauthentic to me. Like, <a class="reference external" href="http://www.google.com/search?hl=en&amp;lr=&amp;q=%22Ned+Holness%22&amp;btnG=Search">Mind of Mencia</a> inauthentic.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/08/this-is-a-seriously-big-deal/">this is a seriously big deal</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-08T00:00:00-05:00">Thursday, 08 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">T</div>
                </header>

                <div class="entry-content">
                    <p>I know that most of my tech posts are completely inscrutable to normal humans. But do me a favor and go read <a class="reference external" href="http://feeds.feedburner.com/~r/oreilly/radar/atom/~3/87934065/pipes_and_filte.html">this</a> O'Reilly Radar post. I frequently disagree with the level of import that O'Reilly assigns to various web developments, but I actually think he's sort of on the money when he says that &quot;Yahoo!'s new Pipes service is a milestone in the history of the internet.&quot; And I haven't even been drinking! Much!</p>
<p>It really is pretty cool. It's a drag and drop interface that lets you perform various web-mashup-y tasks. You can't do anything new with it, but you can do a lot of things much more easily — and with free hosting to boot. This puts the power of the customized web into the hands of everyone.</p>
<p>Here's an example. Let's say that I want to keep tabs on Kriston with just one unified RSS feed. I fire up the Pipes interface, drag a URL-fetching object into the workspace and add the RSS feeds for <a class="reference external" href="http://www.grammarpolice.net">Grammar.police</a>, <a class="reference external" href="http://eyelevel.si.edu">Eye Level</a> and <a class="reference external" href="http://readexpress.com">FreeRide</a>. I drag in a filter object and draw a connection between the URL Fetcher and plug it into the Filter. Then I set the filter to only allow items where the word &quot;kriston&quot; shows up in either of the author fields (a quirk of different RSS formats) or the description field (where the text of the entries lies). Then I draw a link from the Filter to the output. Presto! I now have <a class="reference external" href="http://pipes.yahoo.com/pipes/EmbAcDC32xG.HZCot5qdmw/run?_render=rss">a unified Kriston feed</a>.</p>
<p>But suppose that I feel that this combined stream of art criticism is too accessible to the rabble. I can go back to my workspace and drag a Babelfish object into it, placing it in between the filter and output blocks. I select the desired languages et voila: Kriston's collective output is now available as an <a class="reference external" href="http://pipes.yahoo.com/pipes/dkztwTC32xGuH4osphr.og/run?_render=rss">RSS feed en Francais</a>.</p>
<p>And this is just relatively simple RSS stuff. You can get into querystring parameters, different data sources, string parsing and control structures like <em>if..then</em> blocks and <em>for</em> loops. I've only scratched the surface.</p>
<p>There are two downsides, though. First, as O'Reilly mentions, there are some bugs — the interface doesn't work completely predictably. I had to highlight the filter box in order for it to fully populate the dropdown of filterable fields, and the babelfish module seems to miss some of the entries it's sent. Second, it's currently broken: it appears that the whole thing crashed shortly after I played with it (which was very soon after the O'Reilly post). Who knows if it'll ultimately scale. I hope they get things fixed soon, but a framework as powerful as this is likely on the verge of collapsing under its own complexity. I wouldn't count on the kinks being worked out in a particularly expedient manner.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/07/to-touch-the-face-of-deliciousness/">to touch the face of deliciousness</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-07T14:45:00-05:00">Wednesday, 07 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">T</div>
                </header>

                <div class="entry-content">
                    <p><a class="reference external image-reference" href="http://www.flickr.com/photos/sbma44/382973436/"><img alt="photo of a delicious-looking corndog and some tongs" class="right" src="http://farm1.static.flickr.com/99/382973436_124a0592e3_m.jpg" /></a>Why yes, I <em>do</em> own a deep fryer. It's so sweet of you to notice!</p>
<p>I finally decided that this was the year to take the metaphorical plunge into boiling grease. For the past few [STRIKEOUT:Superbowls] — sorry, <a class="reference external" href="http://www.washingtonmonthly.com/archives/individual/2007_02/010677.php">&quot;Big Games&quot;</a> — I've made buffalo wings the godawful way: deep-frying chicken wings in a pot full of peanut oil, then tossing them with a delicious mixture of butter and <a class="reference external" href="http://www.texaspete.com/">Texas Pete</a>.</p>
<p>Although the wings usually turned out well, the process of making them was always disastrous. A combination of personal impatience, chicken wing frozen-ness and the laws of nature's unpleasant inflexibility generally resulted in a roiling mass of steam and oil clambering out of the pot and spreading itself in a thin layer over every surface in my kitchen. It was disgusting, hard to clean up, and seemed likely to eventually result in a trip to the hospital.</p>
<p>This, combined with Emily's sudden realization that she had a life-long aspiration to make corndogs, led us to Target last Saturday, where we considered their various deep-frying options. Most of the available fryers failed to inspire confidence. At the low-end of the market sat the chintzy Asian models, which looked like and probably were simple rice cookers with various important safety features removed. Their control dials also turned alarmingly freely, making it seem unlikely that they were connected to anything at all. At the other end of the market stood a much more expensive but even-chintzier American fryer. This one had the classic-looking rectangular basket and some impressively substantial knobs. But the rest of the device seemed pretty crappily made, like poorly-considered component of a PlaySkool fast-food-themed set of toys that had been hastily recalled, rebadged and resold.</p>
<p>That left just one remaining option, which was a little bit of a gamble since there was no display model. But ultimately the <a class="reference external" href="http://www.flickr.com/photos/sbma44/378745695/">Friteuse En Huile Profonde</a> seemed like the best idea. &quot;They were right about Iraq, after all,&quot; I thought. &quot;Maybe they'll be right about frying, too.&quot;</p>
<p>Sadly, upon returning home we discovered that the fryer was actually Canadian in origin. Other deficiencies became apparent, too: there was no temperature control, leaving aspiring fryers just one setting (&quot;poutine&quot;) with which to work.</p>
<p>But overall the device didn't disappoint. We made some french fries and they were good (although not as crispy as would've been ideal). Then we trekked over to the flophouse for the Superbowl and made some corndogs and wings. The corndogs were a huge success, but the wings were a little lacking — I didn't fry them as long as I should've, and the result was slightly soggy. Also, they left the wires of the frying basket covered in a disconcerting brown substance. It's probably just miscellaneous chicken gunk (their souls, maybe?), but it could also be that Giant adds chemicals to their chicken wings (&quot;18% broth by volume!&quot;) that can induce stainless steel to rust.</p>
<p>Unfortunately, that's all the frying I've done since making the purchase. The oil was still too hot at the game's conclusion for the fryer to be moved. Besides, <a class="reference external" href="http://toohotfortnr.blogspot.com">Spencer</a> expressed some interest in becoming the fryer's foster father. It's for the best — as a single parent, I simply couldn't provide the sort of environment where a deep-fat fryer could really blossom. It'll ultimately be better off residing in a household where a lot of people care deeply for it — and don't mind every item they own smelling like french fries.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/07/we-love-to-build/">we love to build</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-07T12:44:00-05:00">Wednesday, 07 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">W</div>
                </header>

                <div class="entry-content">
                    <p>Holy crap. That Swimmers album is better than I'd expected — is it too early to start nominating candidates for Album of the Summer? The last few years' poor, belated crops of AoTSes makes me think that it'd best to get way out ahead of this thing. Anyway, you can listen to the whole album over at <a class="reference external" href="http://www.theswimmers.com/">their website</a>. I particularly like &quot;We Love To Build&quot; and &quot;St. Cecilia&quot;.</p>
<p>Relatedly, thanks to their use of the XSPF player the following super-nerdy* command is possible. I normally wouldn't post it, but I think it's the first time I ever actually got sed to do what I wanted.</p>
<blockquote>
<pre class="literal-block">
wget -q -O - http://theswimmers.com/player/playlist.xspf | sed -e '/annotation/d' -e '/playlist/d' -e '/track/d' -e '/encoding/d' -e 's/&lt;\/*location&gt;//g' | xargs wget
</pre>
</blockquote>
<p>A similar technique should be possible with the <a class="reference external" href="http://hype.non-standard.net">Hype Machine</a>, but their failure to use line breaks in their XSPF files makes the regex composition a bit harder, so I haven't bothered to figure it out yet.</p>
<p>* Admittedly, it's not even <em>close</em> to being as nerdy as <a class="reference external" href="http://stevenf.com/2007/01/zeppl_1.php">this</a>, which is awesome (via <a class="reference external" href="http://www.allthegooddomainsweretaken.com/">Miller</a>'s <a class="reference external" href="http://www.allthegooddomainsweretaken.com/">del.icio.us feed</a>).</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/07/smysteries-revealed/">smysteries revealed</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-07T12:29:00-05:00">Wednesday, 07 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">S</div>
                </header>

                <div class="entry-content">
                    <p>Somebody emailed me for help setting up an SMS service, and I ended up spewing out enough words that I thought I might as well commit them to the web. If you want to do something cool and techy with SMS, here are the options that I know of:</p>
<ul class="simple">
<li>You could buy a shortcode and SMS service from a vendor like <a class="reference external" href="http://www.clickatel.com/">Clickatel</a>, then interface with their API. That'd run you around $1000 a month, plus $2k to get it set up (and usage fees). It's how the pros do it, but I imagine it's overkill for your purposes. Let's move on.</li>
<li>You could make a setup like <a class="reference external" href="http://www.dcist.com/archives/2006/05/09/introducing_las.php">LastCall</a>, which uses an open source project called Gammu, a cracked-screen Nokia from ebay, an unlimited SMS plan from T-Mobile and a surprisingly hard-to-get-working phone » serial cable (it took me months to find one that would work under Linux). A bunch of perl scripts (and a little Python) powers it all. I wanted to do this for various reasons, but it ended up taking me months and was a huge pain in the ass. If your application is going to be simpler, I would advise against it.</li>
<li>You could use the <a class="reference external" href="http://www.mozes.com">MOZES</a> service. This is a shared shortcode that provides an API (which is somewhat poorly-documented, as of the last time I checked). You pick a keyword and can use it for a certain number of messages. When you text the keyword followed by a command to the shortcode MOZES it can integrate with your MOZES account in various ways — one of them is to trigger scripts that you've written and which use the MOZES API. This is probably the most accessible way to start using real SMS service. You could probably do something similar with <a class="reference external" href="http://www.twitter.com">Twitter</a>, too (and without the account running out of messages), but that's not what Twitter is designed for and they might shut you down.</li>
<li>Finally, you could simply rely on the carriers' SMS-to-email gateways, which work pretty well. This is what <a class="reference external" href="http://www.traincheck.com">traincheck.com</a> does. It's easy to get a cheap webhost, hook it up to a domain, then create an email address that forwards incoming mail to a PHP, Perl or Python (or whatever else) script (PHP tends to generate bounce messages unless you vigorously suppress every line's output — I'd suggest one of the other two, if they're all the same to you). The only downside here is that the wireless carriers will eventually shut you down if your service becomes heavily-used. But if you just want to automate some part of your and/or your friends' lives with SMS, then this is simple, easy, cheap and works on nearly all phones.</li>
</ul>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/04/automatically-using-the-coral-cdn/">automatically using the coral cdn</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-04T17:16:00-05:00">Sunday, 04 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">A</div>
                </header>

                <div class="entry-content">
                    <p>You might've noticed that I hotlinked those mp3s, providing URLs that point directly at someone else's blog. This is normally considered pretty poor form — you're using up someone else's bandwidth without giving them any associated (and salable) web traffic. But in this case it's not quite so bad: I used the Coral CDN to make the links. That reduces the bandwidth that my visitors will be consuming from the other sites to a negligible amount. NYU picks up most of the bill (and is presumably happy to do so). I wrote a bit more about the Coral CDN <a class="reference external" href="http://www.zunta.org/blog/archives/2005/03/29/ourmedia_sux0rs/">here</a>; you can find their explanation <a class="reference external" href="http://www.coralcdn.org/">here</a>. It's an extremely useful tool, and not just for excusing normally boorish behavior — if you have a large file on your own server, it can come in handy there, too.</p>
<p>The only downside is that it requires that users be able to send web traffic out on port [STRIKEOUT:8090] 8080, which is a slightly unusual requirement. It shouldn't be a problem for most people, but if someone's behind a restrictive corporate firewall, the Coral-ified link might make it impossible for them to get the file.</p>
<p>So to fix that I whipped up this Javascript. It attempts to load a small image (originating on this domain) over the Coral CDN. If it manages to, we know that the visitor can use port [STRIKEOUT:8090] 8080 and access the Coral system. If that condition is met, the script then replaces all the links on the page that go to big-seeming files with ones that use Coral (&quot;big-seeming&quot; is determined by the extension — mp3, mp4, mpg and avi are what the script looks for right now, but it's easy to adjust that). If the image doesn't load, the original link is left alone and will presumably still work for the poor firewalled visitor.</p>
<p>Here's the script:</p>
<blockquote>
<pre class="literal-block">
&lt;script type=&quot;text/javascript&quot;&gt;
function CoralizeLinks()
{
// modify the following line to adjust the extensions used by the function
var EXTENSION_MATCH_RE = new RegExp('\.(mp3|avi|mpg|mp4)$','i');
var x = new Image();
x.src = 'http://www.manifestdensity.net.nyud.net:8080/coral-test.gif';
x.onload = function()
{
var domain = location.href.replace(/http:\/\//i,'').replace(/\/.*$/,'');
var links = document.getElementsByTagName('a')
for(var i=0;i&lt;links.length;i++)
{
if((links[i].href.match(EXTENSION_MATCH_RE))&amp;&amp;(!(links[i].href.match(/\.nyud\.net:80[89]0/i))))
{
if(links[i].href.match(/^http:\/\//i))
links[i].href = links[i].href.replace(/http:\/\/(.*?)\/(.*)$/i,'http://$1.nyud.net:8080/$2');
else if(links[i].href.match(/^\//))
links[i].href = 'http://' + domain + '.nyud.net:8080' + links[i].href;
else
links[i].href = location.href.replace(/\/[^\/]+$/,'/').replace(domain,(domain+'.nyud.net:8080')) + links[i].href;
}
}
};
}
&lt;/script&gt;
</pre>
</blockquote>
<p>To use it on your page just save the file as &quot;coralize.js&quot; and upload it to your webserver. Add this to your template's &lt;head&gt; section:</p>
<blockquote>
<pre class="literal-block">
&lt;script type=&quot;text/javascript&quot; src=&quot;/path/to/coralize.js&quot;&gt;&lt;/script&gt;
</pre>
</blockquote>
<p>And modify your &lt;body&gt; tag like so:</p>
<blockquote>
<pre class="literal-block">
&lt;body onload=&quot;CoralizeLinks()&quot;&gt;
</pre>
</blockquote>
<p>There you go.</p>
<p>And, on an unrelated note, Peyton Manning's dad just said he sent his son a pre-game text message saying how proud he was. It's the future, even for old people!</p>
<p><strong>UPDATE:</strong> Looks like Coral switched to using port 8080 instead of 8090 a while ago (I have no idea why — they say they're going to <a class="reference external" href="http://wiki.coralcdn.org/wiki.php?n=Main.FAQ#highport">start using port 80</a> &quot;as soon as possible&quot;). Port 8090 appears to still work, but I've updated the script anyway. Also, the Coral people appear to use the verb &quot;coralize&quot; instead of &quot;coralify&quot;, and I've adjusted the script to reflect that, too.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/04/bands-you-already-like-without-knowing-it/">bands you already like without knowing it</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-04T13:32:00-05:00">Sunday, 04 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">B</div>
                </header>

                <div class="entry-content">
                    <p>For all I know both of these bands may be blogospheric old news by now. But I'm really enjoying them, so here you go.</p>
<p>Do you like Architecture In Helskini but wish they were brattier, catchier and more British? Of course you do. So you'd better listen to this:</p>
<blockquote>
<a class="reference external" href="http://www.nothingbutgreenlights.net.nyud.net:8080/mp3/Los%20Campesinos%20-%20You!%20Me!%20Dancing!.mp3">Los Campesinos – You! Me! Dancing!</a></blockquote>
<p>And if you like Summerteeth-era Wilco, check out <a class="reference external" href="http://www.theswimmers.com/">The Swimmers</a>:</p>
<blockquote>
<a class="reference external" href="http://www.theswimmers.com.nyud.net:8080/fightingtreesmp3/01_ItsTimeTheyKnew.mp3">The Swimmers – It's Time They Knew</a></blockquote>
<p><strong>UPDATE:</strong> Fixed the link to the Swimmers mp3.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/02/sommers-star-turn/">Sommer's star turn</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-02T12:16:00-05:00">Friday, 02 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">S</div>
                </header>

                <div class="entry-content">
                    <p>Internet veterans may remember the heady days of December of two-thousand and aught-six. In those days an inter-meme spread through the web, cutting down many a blogger in a flurry of third-party-prompted self-absorption. The theme? List five things that people don't know about you.</p>
<p>Pretty much everyone I know — myself included — was afflicted, but the most interesting response came from Sommer, who <a class="reference external" href="http://cruelsommer.blogspot.com/2006/12/five-things.html">revealed</a> that she had been an extra in the movie adaptation of <em>Super Mario Brothers</em>. In her comments, I immediately swore to find and download the film.</p>
<p>And I did! But editing the video to highlight Sommer's contributions proved to be tougher than I had expected. It turns out that Apple's <a class="reference external" href="http://www.apple.com/ilife/imovie/">consumer-level</a> editing tools are great for making videos of, say, Steve Jobs' kids playing soccer, but are significantly less well-suited to highlighting your friend's performance in a confused early-nineties film adaptation of a popular videogame. I finally got the job done with <a class="reference external" href="http://www.parallels.com/">Parallels</a> and a couple of <a class="reference external" href="http://www.virtualdub.org/">ugly</a> but <a class="reference external" href="http://www.debugmode.com/wax/">powerful</a> (and free) Windows applications.</p>
<p>But before you click through to the video, let me set up the clip for you so as to best equip you to appreciate Sommer's performance. Cantankerous New York plumber Mario (Bob Hoskins) and his headstrong but well-meaning younger brother Luigi (John Leguizamo) were minding their own business... when they stumbled into a world beyond their imagination! Chasing after the kidnappers of a friend, the pair find themselves in the Mushroom Kingdom, a subterranean land and/or parallel dimension populated by human-like creatures of reptilian descent and ruled by the tyrannical King Koopa (Dennis Hopper). Koopa is determined to wage war on the human world and claim their plentiful natural resources. But how does the kidnapped Daisy (Samantha Mathis) fit into this fiendish plot? And — more to the point — how will Mario and Luigi save her?</p>
<p>The answer may lie with a mysterious woman in red (Francesca Roberts) and an even more enigmatic power crystal that she's come to possess. It is the singleminded pursuit of this crystal that drives Mario and Luigi in the scene.</p>
<p>As you watch it, consider Sommer's motivation. It's true that her character is unnamed, but in some respects this makes her role all the more universal and important. In a very real sense she represents the Mushroom Kingdom Everyman, living life under an oppressive regime that is all she's ever known. Despite her presumable ignorance of the human world, she must have a sense that something is deeply wrong with her own. The contradictions of a society technologically advanced enough to produce jump-boots yet unable to provide clean air and water are so profound that they will inevitably pervade its citizens' minds with dread, even as they — having never left their world's rotting subterranean embrace — can't quite name what's so desperately wrong, much less escape it. Instead, Sommer and her ilk are doomed — in a nearly Greek tragedian sense — to be storm-tossed by fate, unable to act even as powerful actors move through their midst (sometimes in the very same rooms!). All that she can do is seek panicked, choking respite in the grim, tomblike nightclubs of her dying world as she unknowingly waits for salvation — or the liberating release of death.</p>
<p>And, on a more Inside-The-Actor's-Studio sort of note, it's worth mentioning that the kidnapped Princess Daisy is played by Sommer's own sister. Immersed in the Method but still green to the trade and desperate to conceal sororial concern for someone that should be unknown to Sommer's own character, it's an understatement to say that the emotions at work within the young actress must have been heady and barely-tameable. It's a distinct privilege to watch their interplay over the course of her performance.</p>
<p>Finally, let me offer my apologies for the resolution of this clip — for now, it's the best that I could find. There's no mention of it on the webpage <a class="reference external" href="http://www.criterionco.com/asp/coming_soon.asp">yet</a>, but I can only assume that the Criterion Collection anamorphic DVD print is forthcoming.</p>
<p><center><script type="text/javascript" src="http://blip.tv/scripts/pokkariPlayer.js"></script><script type="text/javascript" src="http://blip.tv/syndication/write_player?skin=js&amp;posts_id=145778&amp;source=3&amp;autoplay=true&amp;file_type=flv&amp;player_width=&amp;player_height="></script><div class="docutils container" id="blip-movie-content-145778">
<a class="reference external image-reference" href="http://blip.tv/file/get/Sbma44-SommerRecompress126.flv"><img alt="image1" src="/static/2007/02/02/_bigmediamathis.jpg" style="width: 500px; height: 394px;" /></a>
<a class="reference external" href="http://blip.tv/file/get/Sbma44-SommerRecompress126.flv">Click To Play</a></div>
</center></p>
                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/01/better-full-text-rss/">better full-text RSS</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-01T16:34:00-05:00">Thursday, 01 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">B</div>
                </header>

                <div class="entry-content">
                    <p>Remember <a class="reference external" href="/2006/12/19/do-me-a-favor/">when I asked for help</a> testing a script I'd written that turns partial-text RSS feeds into full-text ones? And it sort of sucked, but not entirely?</p>
<p>Well, I thought about it some more and came up with a way to significantly improve the algorithm. So I took another pass at it (improving the caching mechanism while I was at it) and I'm pretty happy with the results. But I'd like to test it some more before moving it to its final home. If you've got a partial-text feed that's been bugging you, please give it a try. And if it fails to work on any particular feeds, please let me know about them in comments.</p>
<div class="docutils container">
<form action="http://www.metamonkey.net/fulltextrss2/" method="get"><p>RSS Feed URL</p>
</form></div>
<p><strong>UPDATE:</strong> Looks like the dates on the feeds produced by this tool are screwed up. I'll fix that soon.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/01/31/on-a-more-electronics-friendly-note/">on a more electronics-friendly note</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-01-31T23:15:00-05:00">Wednesday, 31 January 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">O</div>
                </header>

                <div class="entry-content">
                    <p>The first Wii modchips are <a class="reference external" href="http://www.maxconsole.net/?mode=news&amp;newsid=13974">on their way to the public</a>. Via <a class="reference external" href="http://www.engadget.com/2007/01/26/wiinja-modchip-enables-wii-gamecube-backups-to-function/">Engadget</a>.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/01/31/say-goodbye-cavemen/">say goodbye, cavemen</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-01-31T21:25:00-05:00">Wednesday, 31 January 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">S</div>
                </header>

                <div class="entry-content">
                    <p><img alt="photo of a mooninite by flickr user medildo, used under an ex-boyfriend license" class="center" src="http://farm1.static.flickr.com/142/376138310_d9d4f3632f_o.jpg" /></p>
<p>So, Boston's <a class="reference external" href="http://www.local10.com/news/10888268/detail.html">gone crazy</a> because Outsiders harnessed the fire from the sky to make graven images. Here's the part that really gets me:</p>
<blockquote>
The first device was found under Interstate 93, and the state police bomb squad was called and detonated the package in Sullivan Square just before 10 a.m. Officials said it contained an electronic circuit board with some components that were &quot;consistent with an improvised explosive device,&quot; but they said it had no explosives.</blockquote>
<p>Consistent with an IED. Right. So, assuming that these Cartoon Network signs weren't any more complex than they had to be, what components made them IED-equivalents?</p>
<ul class="simple">
<li>power source (battery)</li>
<li>light source (LEDs)</li>
<li>wires</li>
<li>timer/controller (cheap IC or microcontroller)</li>
<li>maybe a light sensor (photodiode or photoresistor)</li>
<li>not explosives</li>
</ul>
<p>I have two qualifying devices on my person right now. Drop the photodiode requirement and I've got another three in my backpack. I count twelve in my line of sight.</p>
<p><img alt="photo of a painting of the Aqua Teen Hunger Force by Flickr user medildo" class="right" src="http://farm1.static.flickr.com/185/376138267_e263a1f245_o.jpg" />I get that it's sort of fun to follow federal protocols and act all serious. But c'mon — the number of mysterious electronic devices that come into our day to day lives is not going to suddenly begin declining. These signs were in several other towns for weeks without the cops freaking out and shutting down the city. Bostonians are just going to need to learn to deal with this kind of stuff. And I <em>really</em> don't like that CNN has inexplicably dragged my beloved <a class="reference external" href="http://www.makezine.com/blog/archive/2007/01/aqua_teen_hunge_1.html">MAKE Magazine</a> into this mess.</p>
<p>I don't mean to voice support for the ad campaign, of course, despite my affection for Aqua Teen Hunger Force. Guerilla marketers like <a class="reference external" href="http://www.interferenceinc.com/">Interference Inc.</a> (who appear to be behind this scheme) are <a class="reference external" href="http://www.dcist.com/archives/2006/03/27/verizon_this_do.php">scumbags</a> and <a class="reference external" href="http://youthoughtwewouldntnotice.com/blog3/">thieves</a>, helping themselves to our public spaces and ripping off other people's art. But I'm even less fond of the humorless morons who shut down Boston and seem likely to drag <a class="reference external" href="http://www.flickr.com/photos/medildo/tags/cartoonnetwork">Williams Street</a> into court.</p>
<p>Other than that, the whole thing's pretty funny. And I'm looking forward to hearing more about this from two outlets in particular: <a class="reference external" href="http://www.schneier.com/blog/">Bruce Schneier</a>, and <a class="reference external" href="http://boards.adultswim.com/adultswim/board/message?board.id=3&amp;message.id=448037&amp;jump=true">Adult Swim's black &amp; white bumps</a>.</p>
<p><strong>UPDATE:</strong> It's worse than I thought! From <a class="reference external" href="http://edition.cnn.com/2007/US/01/31/boston.bombscare/index.html">CNN</a>:</p>
<blockquote>
&quot;It had a very sinister appearance,&quot; Coakley told reporters. &quot;It had a battery behind it, and wires.&quot;</blockquote>
<p>Holy shit! I think I've got some sort of chronometric doomsday device looming over me <a class="reference external" href="http://www.flickr.com/photos/sbma44/376157604/">right now</a>!</p>
<p><strong>UPDATE 2:</strong> Check out alpha-geek <a class="reference external" href="http://www.bunniestudios.com/wordpress/?p=151">Bunnie Huang's response</a> to the incident.</p>
<p><strong>UPDATE 3:</strong> MAKE has <a class="reference external" href="http://www.makezine.com/blog/archive/2007/02/boston_moonimit.html?CMP=OTC-0D6B48984890">close-up shots of one of the signs</a>. There's a few AA batteries, a voltage regulator, a small microcontroller, an inductor, what I think is an LED driver, a photoresistor, and a bunch of diodes, capacitors, resistors and LEDs. You could comfortably hold all of these components in your cupped palm. None of them costs much more than a dollar, and most are only a few cents. And, based on my admittedly amateur knowledge of electronics, none could destroy a major American city.</p>
<p><strong>UPDATE 4:</strong> <a class="reference external" href="http://www.allthegooddomainsweretaken.com">Justin</a> sent along <a class="reference external" href="http://lgbusinesssolutions.typepad.com/solutions_to_grow_your_bu/2007/02/bombed_in_bosto.html">this</a> analysis of the campaign from a marketing perspective. The bizsolutions blogger thinks that making the campaign higher profile (by involving alternative media, among other things), these problems could have been avoided. I agree that putting a phone number on the signs for law enforcement (not the public) to call could have saved everyone a lot of trouble, but otherwise I disagree with this analysis. The whole point of the campaign is to evoke the subversive work of people like <a class="reference external" href="http://www.obeygiant.com/">Shepard Fairey</a> and <a class="reference external" href="http://graffitiresearchlab.com/?page_id=19#video">Graffiti Research Labs</a>. Thinking of this as just another illuminated billboard totally misunderstands the Adult Swim brand and how it has been presented up to this point. AS viewers like the idea that they're in on a secret. The ideal outcome for this campaign was to get people talking and a bunch of threads started on message boards. Issuing directions, treating the campaign like a scavenger hunt and interviewing sign-finders on the HOT! 99.n Morning Show runs completely contrary to that idea. Cartoon Network's huge success is in part due to a huge amount of respect for its audience. It doesn't strike me as the sort of relationship that's compatible with traditional marketing techniques.</p>
<p><em>The photos of Williams Street belong to</em> <a class="reference external" href="http://www.flickr.com/photos/medildo/201156447/">Catherine</a><em>, who I assume won't sue me for using them. They're of the</em> <a class="reference external" href="http://www.zunta.org/blog/archives/2006/07/31/home_again_home/">tour</a> <em>of Adult Swim HQ that we were lucky enough to be given back in July.</em></p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/01/31/its-all-just-bits/">it's all just bits</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-01-31T15:46:00-05:00">Wednesday, 31 January 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">I</div>
                </header>

                <div class="entry-content">
                    <p>The assuredly-distinct-from-me Tim Lee has <a class="reference external" href="http://www.techliberation.com/archives/041952.php">a post about videogame piracy</a> over at the excellent Tech Liberation Front that doesn't seem quite right to me. I started to leave this as a comment, but it sort of got out of hand.</p>
<p>Tim discusses the case of Eastside Hockey Manager 2007, a popular game made thoroughly and obviously unprofitable by piracy. He ends by noting that he's sympathetic to arguments that copyright protections aren't necessary for music, but still thinks that they are essential if we're to preserve industries like the one that makes videogames.</p>
<p>To some extent I think Tim is right: music is a unique case. But that's mostly because the industry that arose to distribute music was so bloated, stupid and inefficient. Having claimed nearly all of the profit from retail music sales, the record companies are the part of the music industry that'll withering first in the face of rampant piracy. That's shielding the actual music creators from piracy's effects — for now, anyway. Successful but non-superstar artists found different, largely concert- and merch-based means of earning a living a while ago.</p>
<p>But the lack of a large, parasitic &amp; evil distribution mechanism (or at least one <em>as</em> evil) doesn't mean that the videogame industry can be saved by copyright any more than the record companies can (the question of whether it <em>should</em> be saved strikes me as fairly irrelevant). The game companies' business is vulnerable, too, and will ultimately have to transform itself. The wealth of DRM options available to game-makers and the console vendors' closed systems give them a more luxurious position, but with the rise of networked consoles and the maturation of a market for pirate technologies like Alcohol 120% and console modchips, that era is coming to an end.</p>
<p>But that's okay. The bloated budgets of the high-profile videogame franchises is a bug, not a feature. Look at the <a class="reference external" href="http://www.xbox-scene.com/xbox1data/sep/EEZpEZluAEYtkTwODn.php">success of the videogames Burger King has been selling</a> — they're short and simple, but they only cost a few bucks and the restaurant has sold 3.2 million of them. I'm sure they were envisioned as a promotional tool more than anything else, but now BK is claiming they helped their bottom line. There's clearly room for growth in this segment of the market. The idea that every videogame has to be a (shooter|RPG|platformer|sports game|GTA clone) and cost $60 is ridiculous.</p>
<p>Piracy's going to continue to be effective. It's also going to become much more accessible to people without soldering irons and Linux servers. The industry will respond by chasing ad revenue; by adjusting the cost:benefit ratio for piracy by making smaller, cheaper games; and by continuing to move toward service-based offerings (e.g. subscription fees in MMORPGs). For Madden devotees, this is bad news. For those of us bored by the industry's addiction to big titles and consequent inability to innovate, it's not a bad thing at all.</p>
<p>Yglesias has made arguments similar to Tim's about the movie industry — that pirating music might be okay, but that the film industry couldn't continue to produce content of the same quality if their profit margins decreased. As I've <a class="reference external" href="http://www.beggingtodiffer.com/2005/06/28/money-for-nothing-flicks-for-free">argued before</a>, I think this is mostly just a problem of imagination: it's easy to imagine getting together the resources necessary to produce a very good-sounding album, and it has been for some time. Producing a professional-quality movie is a massively more expensive and inaccessible undertaking.</p>
<p>But this becomes less true every day. We're already past the point where a bunch of friends can make a decent movie while holding down day jobs. It wasn't too long ago that getting a good-quality camera and nonlinear editing rig meant an investment of tens of thousands of dollars. Now you can do it for an order of magnitude less. This stuff is going to continue to get cheaper and easier.</p>
<p>At this point I imagine that my <a class="reference external" href="http://cruelsommer.blogspot.com">cinematically knowledgeable</a> friends will scoff and start talking about lighting design, makeup, film versus DV and other things that I don't know enough about to sound convincing. But I still believe in technology's ability to democratize the medium: the procedurally-generated extras of <a class="reference external" href="http://www.wetadigital.com/digital/">Weta Digital</a> will show up on the desktop soon enough, and the slickness of fan productions like <a class="reference external" href="http://www.panicstruckpro.com/revelations/">Star Wars: Revelations</a> hints at a promising (albeit terribly-acted) future.</p>
<p>It'll probably always be the case that a professional can discern between the work of a colleague and that of a skilled amateur. But it also probably won't matter — in the same way that readers of political punditry turn out to not care all that much about copy-editing, I suspect the film world will end up finding that the priorities and standards they've set for themselves are different from those of their audience.</p>
<p>And that's good, because I think we're just beginning to enter the golden age of digital movie piracy. As Yglesias has noted, there's a bloated market inefficiency here, too — star salaries — which can be pared down to make up for lost revenue, in the same way that the record companies will be pared down before artists suffer. But I suspect the movie industry is going to be in a serious panic mode within a decade.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/01/30/the-latest-advance-from-hell-labs/">the latest advance from Hell Labs</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-01-30T13:50:00-05:00">Tuesday, 30 January 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">T</div>
                </header>

                <div class="entry-content">
                    <p><a class="reference external image-reference" href="http://www.flickr.com/photos/sbma44/374687182/"><img alt="a toy representing the Simpsons Halloween Special scene in which Homer is forced to eat countless donuts in Hell Labs' Ironic Punishment Division" class="center" src="http://farm1.static.flickr.com/182/374687182_f3845170e9.jpg" /></a></p>
<p>We get some really excellent toys in the office. It's almost entirely <a class="reference external" href="http://www.nicco.org">Nicco's</a> fault (although I've been lobbying to get one of <a class="reference external" href="http://www.thinkgeek.com/geektoys/warfare/86b8/">these</a> ever since <a class="reference external" href="http://dcist.com/staff.php#dcist_april">April</a> told me they can be run from Linux).</p>
<p>This one's probably my favorite so far. Unfortunately the cranking mechanism isn't timed quite right, and the donuts usually end up sliding off Homer's mouth instead of down his gullet and into the collection tray. It's still pretty great, though.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/01/29/fighting-movable-type-comment-spam-part-4/">fighting movable type comment spam - part 4</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-01-29T01:29:00-05:00">Monday, 29 January 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">F</div>
                </header>

                <div class="entry-content">
                    <p>Okay. Last one, I promise. Now that you've gone through all of these steps, here are the things that you probably should have tried before listening to me:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.unfogged.com/archives/week_2006_06_11.html#005044">Ben</a>'s querystring-based twist on JS obfuscation has apparently been highly successful. It's simple and clever — give it a try. It also makes me realize that my rotating-mt-comments solution could've been implemented with .htaccess files, eliminating the need for FTP nonsense and allowing us to avoid making changes to mt-config.cgi. That'd be a better way to do it, but the benefits aren't enough to make me rewrite the script. Plus, not everyone has mod_rewrite enabled, so the original solution will work on slightly more systems.</li>
<li><a class="reference external" href="http://appnel.com/kb/mtakismet/mtakismet-manual">MT-Akismet</a> is a Movable Type plugin that brings the power of <a class="reference external" href="http://www.wordpress.org">Wordpress</a>'s Akismet spam-blocking system to MT. I installed it a few weeks ago and it seems to have helped, although in my case it didn't completely eliminate the flow of spam. Considering that I don't get all that much comment spam at this domain, that makes me disinclined to pimp MT-Akismet as a magic bullet. But it seems to do something, and does so without needing supervision. Also, lots of people swear by it. You might as well give it a try.</li>
<li><a class="reference external" href="http://www.sixapart.com/pronet/plugins/plugin/captcha.html">Captchas</a> are probably the most foolproof method of stopping spam. But users don't like them, and in my experience they're a pain in the ass to install. Still, if you want to stymie the spammers, this is probably the best way to do it.</li>
<li>There's always TypeKey, MT's unified login solution. In my experience, it's <a class="reference external" href="http://www.dcist.com/archives/2006/01/04/typekeys_reign_1.php">terrible</a>. Admittedly, the situation at DCist was worse than normal because Gothamist's server architecture meant that comments had to be submitted across a few different domain names, which made TypeKey's cookies go crazy. But overall, I came away deeply unimpressed.</li>
<li>Finally, there are a <a class="reference external" href="http://www.sixapart.com/pronet/plugins/plugin/closecomments.html">couple</a> of <a class="reference external" href="http://www.sixapart.com/pronet/plugins/plugin/conversation_ki.html">plugins</a> that will close comments on older entries. There are downsides — people wandering in from Google won't be able to leave their thoughts on your old entries — but if you don't mind them, it should help.</li>
</ul>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/01/29/fighting-movable-type-comment-spam-part-3/">fighting movable type comment spam - part 3</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-01-29T00:16:00-05:00">Monday, 29 January 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">F</div>
                </header>

                <div class="entry-content">
                    <p>We've made some good progress. In <a class="reference external" href="/2007/01/26/fighting-movable-type-comment-spam-part-1/">part one</a> I talked about how comment spammers operate and some theoretical ways to stop them. In <a class="reference external" href="/2007/01/26/fighting-movable-type-comment-spam-part-1/">part two</a> I offered a little more practical advice, providing a walkthrough on how to convert an MT site from static HTML pages to PHP and offering more specific instructions on how to hide where your comment script lives. I know that at least one person has seen a reduction in comment spam as a result, which makes me pretty pleased.</p>
<p>Sadly, what we've covered so far isn't enough. Spammers will find your renamed mt-comments.cgi no matter how much Javascript you bury it under. If users can use the form, so can spammers. They'll find the new location of mt-comments.cgi sooner or later, and then we'll be back at square one.</p>
<p>But what if mt-comments kept changing its location? We can write a script that renames the file every time it runs, then set it to run at a regular interval. That way even when a spammer manages to find it they'll only be able to send spam until the next time the script runs. It'll be great! There are a couple of problems with this approach, though:</p>
<ol class="arabic">
<li><p class="first">If the script runs while a user is composing a comment, when they hit submit the form will send its data to a version of mt-comments that no longer exists. That could be a major pain in the ass. Fortunately, there's a pretty simple solution: we'll just keep two copies of mt-comments around at a time, deleting old ones and adding new ones on a rolling basis. That way a user would have to keep their browser open for two script-intervals in order for their comment to be lost.</p>
</li>
<li><div class="first line-block">
<div class="line">The bigger problem is how to let the site's comment forms know about the changing location of mt-comments.cgi. You might recall that Movable Type sticks these values into its templates with code that looks like this:</div>
</div>
<blockquote>
<pre class="literal-block">
action=&quot;&lt;$MTCGIPath$&gt;&lt;$MTCommentScript$&gt;&quot;
</pre>
</blockquote>
<div class="line-block">
<div class="line">That's fine in theory, but in practice it doesn't work out very well. That's because in order to update those values, Movable Type requires that you rebuild the site. That means we'd be recomposing every page on the blog every time the mt-comments script was renamed. Users wouldn't like the slowdown, and your webhost would get upset about the system resources that you'd end up hogging.</div>
<div class="line">So instead we'll drop the &lt;$MTCGIPath$&gt;&lt;$MTCommentScript$&gt; nonsense and just use some PHP. That'll let us keep track of the mt-comments script in a single PHP file. When a comment form is loaded it'll read the file and use whatever it finds there. It'll be plenty fast and it won't require that any pages be rebuilt.</div>
</div>
</li>
</ol>
<p>So here's the script:</p>
<blockquote>
<pre class="literal-block">
&lt;?php
// CONFIGURATION
$SECRET = 'mysecret';
$MT_DIRECTORY = '/public_html/mt/';
$WRITEABLE_DIRECTORY = '/tmp/';
$ftp_info = array(
'host' =&gt; 'ftp.yourwebhost.com',
'user' =&gt; 'your_login',
'password' =&gt; 'your_password',
'port' =&gt; 21
);
// END CONFIGURATION
if(isset($_GET[$SECRET])):
// login, get mt-config.cgi
$ftp = ftp_connect($ftp_info['host'],$ftp_info['port']) or die('Couldn\'t connect to FTP service.  Is your FTP info correct?');
ftp_login($ftp,$ftp_info['user'],$ftp_info['password']);
ftp_chdir($ftp,$MT_DIRECTORY);
ftp_get($ftp,$WRITEABLE_DIRECTORY . 'mt-config.cgi','mt-config.cgi',FTP_ASCII);
// retrieve the config file
$handle = fopen($WRITEABLE_DIRECTORY . 'mt-config.cgi','r');
$mt_config = fread($handle, filesize($WRITEABLE_DIRECTORY . 'mt-config.cgi'));
fclose($handle);
// split it up, process each line
$mt_config = split(&quot;\n&quot;,$mt_config);
$new_mt_config = '';
$comment_script_current = 'mt-comments.cgi';
$comment_script_old = 'mt-comments-old.cgi';
$mt_cgipath = '';
foreach($mt_config as $line)
{
$line = trim($line);
if(preg_match('/^\s*CommentScript\s+(.*)/i',$line,$matches))
$comment_script_current = $matches[1];
elseif(preg_match('/^\s*#\s*OldCommentScript\s+(.*)/i',$line,$matches))
$comment_script_old = $matches[1];
elseif(!preg_match('/##### Added by mt\-rotate\.php #####/i',$line))
{
if(preg_match('/^\s*CGIPath\s+(.*)/i',$line,$matches))
{
$mt_cgipath = $matches[1];
if(substr($mt_cgipath,-1)!='/')
$mt_cgipath .= '/';
}
$new_mt_config .= $line . &quot;\r\n&quot;;
}
}
$new_mt_config = trim($new_mt_config); // get rid of trailing newline chars
// get mt-comments.cgi
ftp_get($ftp,$WRITEABLE_DIRECTORY . $comment_script_current,$comment_script_current,FTP_ASCII);
// generate a new name for mt-comments.cgi (20 chars, a-z, upper &amp; lower case)
$comment_script_new = '';
while(strlen($comment_script_new)&lt;20)
{
$newchar = chr(ord('a') + rand(0,25));
$comment_script_new .= (((rand()%2)==0) ? $newchar : strtoupper($newchar));
}
$comment_script_new .= '.cgi';
// rename the current comment script
rename($WRITEABLE_DIRECTORY . $comment_script_current, $WRITEABLE_DIRECTORY . $comment_script_new);
// rewrite mt-config.cgi
$new_mt_config .= &quot;\r\n\r\n##### Added by mt-rotate.php #####\r\n&quot;;
$new_mt_config .= &quot;CommentScript $comment_script_new\r\n&quot;;
$new_mt_config .= &quot;# OldCommentScript $comment_script_current\r\n&quot;;
$handle = fopen($WRITEABLE_DIRECTORY . 'mt-config.cgi', 'w');
fwrite($handle,$new_mt_config);
fclose($handle);
// rewrite the PHP include
$php_include = &quot;&lt;?php \$PATH_TO_MT_COMMENTS = '&quot; . $mt_cgipath . $comment_script_new . &quot;'; ?&gt;&quot;;
$handle = fopen($WRITEABLE_DIRECTORY . 'mt-comments-location.php','w');
fwrite($handle,$php_include);
fclose($handle);
// upload the new mt-config.cgi
ftp_put($ftp,'mt-config.cgi',$WRITEABLE_DIRECTORY . 'mt-config.cgi',FTP_ASCII);
// upload the new comment script and set its permissions
ftp_put($ftp,$comment_script_new,$WRITEABLE_DIRECTORY . $comment_script_new,FTP_ASCII);
ftp_site($ftp,&quot;CHMOD 0755 $comment_script_new&quot;);
// delete the old comment script
ftp_delete($ftp,$comment_script_old);
// upload mt-comments-location.php
ftp_put($ftp,'mt-comments-location.php',$WRITEABLE_DIRECTORY . 'mt-comments-location.php',FTP_ASCII);
ftp_close($ftp);
// clean up the temp directory
unlink($WRITEABLE_DIRECTORY . $comment_script_new);
unlink($WRITEABLE_DIRECTORY . 'mt-config.cgi');
unlink($WRITEABLE_DIRECTORY . 'mt-comments-location.php');
endif;
?&gt;
</pre>
</blockquote>
<p>You'll notice that there's a bunch of info to fill in at the top. Most of it should be pretty straightforward. You'll need the FTP info for your webhost account — even though we'll run the script on the same machine as your blog, it needs to connect to itself by FTP in order to make sure that the permissions on the files can be set correctly.</p>
<p>The $WRITEABLE_DIRECTORY value can probably be ignored — /tmp/ should work on pretty much every webhost out there. If it doesn't work, you can just create a directory with permissions set to 777 somewhere and point the script at it. But mostly, don't worry about it.</p>
<p>The $MT_DIRECTORY variable needs to point at the directory where Movable Type is installed, and needs to do so from an FTP client's perspective. Connect to your site with an FTP client and browse to your MT directory. You should be able to figure it out from there.</p>
<p>Finally, $SECRET should be set to a unique string. No weird characters or spaces, either — this needs to be able to be added to a URL, so stick to a simple alphanumeric password. This is necessary because running the script too often could constitute a denial-of-service attack on your blog, effectively making it impossible for anyone to comment. Putting a password in a querystring is generally a terrible idea, but since the requests for this script won't be going out over the internet (or outside the host machine at all) it should probably be okay.</p>
<p>Once you've set all of those values, save the script as <strong>mt-rotate.php</strong> and upload it to the directory where Movable Type is installed (i.e. the one where mt.cgi and mt-config.cgi live). Now it's ready to be tested. Fire up your browser and head to:</p>
<blockquote>
<a class="reference external" href="http://www.yourdomain.com/mt/mt-rotate.php?mysecret">http://www.yourdomain.com/mt/mt-rotate.php?mysecret</a></blockquote>
<p>Of course, change the path so that you're pointing at the right domain and the correct directory. And change &quot;mysecret&quot; to match whatever you set the $SECRET variable to in the script. If all goes well you shouldn't see anything at all — FTP into the site, check the Movable Type directory and confirm that it now has a file called mt-comments-location.php in it, that there's a file with a gibberish name (but ending in .cgi) and that mt-config.cgi now has a line at the bottom mentioning mt-rotate.php. If instead of all of this you see error messages in your web browser, well, something's wrong. Leave a comment and we'll sort it out.</p>
<p>So we can now rotate our comment script's filename every time we call this particular URL. And the new, secret name of the file is kept in mt-comments-location.php in the MT directory. Now we just need to adjust our comment forms so that they can use that PHP file, then set the mt-rotate script to run on an automatic basis.</p>
<p>In order to use mt-comments-location.php, we'll need to know where it resides. Unfortunately, that might be a problem. The $MT_DIRECTORY value may or may not match up with the full path to this file; it all depends on your webhost. I've put together a little script to make it easier to figure out. Download <a class="reference external" href="/static/2007/01/29/where-am-i.php.txt">this</a>, rename it to where-am-i.php (take the .txt off the end) and upload it to the MT directory on the server. Load it up in your web browser (<a class="reference external" href="http://www.yourserver.com/path/to/mt/where-am-i.php">http://www.yourserver.com/path/to/mt/where-am-i.php</a>) and have a look at the output. It ought to tell you what the filesystem path to the MT directory is.</p>
<p>So! You now have the information necessary to rewrite your comment form's <em>action</em> property on the fly. If you didn't add the Javascript obfuscation from <a class="reference external" href="/2007/01/26/fighting-movable-type-comment-spam-part-1/">part two</a>, your comment form tag should still look something like this:</p>
<blockquote>
<pre class="literal-block">
&lt;form method=&quot;post&quot; action=&quot;&lt;$MTCGIPath$&gt;&lt;$MTCommentScript$&gt;&quot; name=&quot;comments_form&quot; onsubmit=&quot;if (this.bakecookie.checked) rememberMe(this)&quot;&gt;
</pre>
</blockquote>
<p>You'll need to add a PHP include statement, then some code to use the variable that becomes available by virtue of the include. Use this, but replace the /path/to/mt/ with the correct filesystem path where Movable Type resides:</p>
<blockquote>
<pre class="literal-block">
&lt;?php include('/path/to/mt/mt-comments-location.php');?&gt;
&lt;form method=&quot;post&quot; action=&quot;&lt;php print $PATH_TO_MT_COMMENTS;$&gt;&quot; name=&quot;comments_form&quot; onsubmit=&quot;if (this.bakecookie.checked) rememberMe(this)&quot;&gt;
</pre>
</blockquote>
<p>If you <em>did</em> implement the Javascript obfuscation, you'll just want to swap &lt;$MTCGIPath$&gt;&lt;$MTCommentScript$&gt; and replace it with $PATH_TO_MT_COMMENTS. Like so:</p>
<blockquote>
<pre class="literal-block">
&lt;?php include('/path/to/mt/mt-comments-location.php');?&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
&lt;?php print ObfuscateJS(&quot;document.comments_form.action = '$PATH_TO_MT_COMMENTS';&quot;);?&gt;
&lt;/script&gt;
</pre>
</blockquote>
<p>Make this change in all the templates that have a comment form in them, then rebuild your site (or just open and re-save one entry, if you'd prefer to make sure things are working before rebuilding all of your site's comment forms). If your comment form seems to be working, you're in great shape. If you see PHP warning messages showing up on the page around where you added the <em>include()</em> statement, odds are that you got the path to mt-comments-location.php wrong.</p>
<p>But let's say that you didn't. You're pretty much all set — all you need to do is call the script on a regular basis.</p>
<p>The way to do this is with a cron job — these are tasks that can be scheduled to occur at regular intervals on a Unix-style system. You should be able to set up a cron job through your web host's control panel software. This is where you manage the domain's email addresses, among other things. It can vary between hosts, but if you look for &quot;cron jobs&quot; or &quot;scheduled tasks&quot; you should probably be able to find it.</p>
<p>cPanel is probably the most popular of these kinds of control panel software packages, and it happens to be what my webhost uses. So let's have a look at how to make it work:</p>
<div class="line-block">
<div class="line"><a class="reference external image-reference" href="http://www.flickr.com/photo_zoom.gne?id=372926381&amp;size=o"><img alt="finding the cron item in cPanel" src="http://farm1.static.flickr.com/129/372926381_a4cadcd99f_t.jpg" /></a></div>
<div class="line"><a class="reference external image-reference" href="http://www.flickr.com/photo_zoom.gne?id=372926312&amp;size=o"><img alt="selecting the standard cron mode" src="http://farm1.static.flickr.com/127/372926312_c33ec4d09b_t.jpg" /></a></div>
<div class="line"><a class="reference external image-reference" href="http://www.flickr.com/photo_zoom.gne?id=372926431&amp;size=o"><img alt="here's the punchline" src="http://farm1.static.flickr.com/156/372926431_64a05725d4_t.jpg" /></a></div>
</div>
<p>It ought to be relatively self-explanatory, particularly if you have a look at the above screenshots. But here's the punchline, the command that you want to run every time the cron does:</p>
<blockquote>
<pre class="literal-block">
wget http://manifestdensity.net/mt/mt-rotate.php?mysecret -O/dev/null
</pre>
</blockquote>
<div class="line-block">
<div class="line">&quot;wget&quot; is a program that fetches webpages. The first parameter specifies the URL we want it to fetch (be sure to replace</div>
<div class="line">&quot;mysecret&quot; with a real value). And the second says to send the retrieved HTML staight to the trash (otherwise it might generate a bunch of junk files in some directory or another). We don't need to hang onto the output, anyway — it's the incoming request that triggers the script's actions. The HTML it produces (or doesn't in this case — remember, there should be no output if it works right) is irrelevant except for debugging purposes.</div>
</div>
<p>And, with that somewhat anticlimactic final step, we should be done. The cron should fire however often you set it to (as you can see from the screenshot, I told it to fire once an hour — that seems like a good number to me). When it does, the necessary files will be renamed and updated, and your Movable Type installation should remain fairly spam-free. Hurrah!</p>
<p><strong>UPDATE:</strong> Whoops! My mistake: I didn't realize that the comment preview template can't be made to use PHP — the filename will always end in .cgi, because it *is* the mt-comments script. You might have noticed this when you implemented part two and ended up with non-working Javascript.</p>
<p>The good news is that there's an easy workaround: <strong>simply remove the action attribute from the comment preview template's form tag entirely</strong>. This will make the form submit to itself. If someone's at the preview form, they already know the URL, which means they have the comment script name and there's no point in hiding it anyway.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/01/27/fighting-movable-type-comment-spam-part-2/">fighting movable type comment spam - part 2</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-01-27T13:43:00-05:00">Saturday, 27 January 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">F</div>
                </header>

                <div class="entry-content">
                    <p><a class="reference external" href="http://www.informationleafblower.com">Kyle</a> and <a class="reference external" href="http://www.jeffnye.org">Jeff</a> rightly pointed out that yesterday's bout of MT-theorizing (aka <a class="reference external" href="/2007/01/26/fighting-movable-type-comment-spam-part-1/">part 1</a>) — however marginally interesting it might have been — wasn't all that helpful. They're right. I didn't write it in a practically-minded sort of way. So here's a shot at explaining how you'd use the stuff I discussed. And, happily enough, some of these steps are necessary for you to use the upcoming method that I alluded to at the end of the last post — so I would've had to write a large part of this anyway.</p>
<p>First things first. The Javascript obfuscator function that I wrote about is written in PHP. More importantly, the rotating comment script functionality I keep alluding to (and which will be a considerably more powerful anti-spam measure) will rely on PHP. But if your Movable Type site was installed with the default settings, its pages aren't PHP — they're just HTML (Jeff and Kyle: I checked, and this applies to both of you).</p>
<p>So what does this mean, and how do we fix it? Well, PHP is a server-side scripting language. When it serves a webpage out to a user it looks for PHP code in it (marked by blocks beginning with &quot;&lt;?php&quot; and ending with &quot;?&gt;&quot;) and runs it before sending the resulting HTML to a user's web browser. You can do all kinds of useful things with PHP — talk to databases, manage user sessions, create graphics, compose PDFs — but we'll just be using some of its most basic functionality. But even if you weren't trying to fight comment spam I think that converting your site to PHP would be a good idea. There are a lot of neat things that people have written in it that you might want to use someday.</p>
<p>By default PHP doesn't run on every web page coming from a server. Instead, it only runs on pages whose names end in .php — this is done for efficiency's sake, so that PHP is only invoked when necessary. If you have complete control over the server you can change this. But for you, me, and anyone else bothering to read this, you won't have that level of control. So instead we need to make Movable Type begin to generate .php files instead of .html.</p>
<p>Doing this is actually pretty easy. First, go to the templates section of your blog's MT administrative interface. By default you should be looking at the Index Templates. You'll notice that there's a list of &quot;Output Files&quot;. Find one of these that ends in &quot;.html&quot; and click on the template name. You should see a screen that looks like this:</p>
<p><a class="reference external image-reference" href="http://www.flickr.com/photo_zoom.gne?id=370935695&amp;size=o"><img alt="changing a movable type template's output file extension" class="center" src="http://farm1.static.flickr.com/162/370935695_7019159597.jpg" /></a></p>
<p>I've highlighted the extension in yellow. Just change it from &quot;html&quot; to &quot;php&quot; and save the template. Do this for each template in the Index Templates section that has an Output File ending in .html. The next time that your site is rebuilt, the index templates will have .php extensions — so instead of index.html, you'll get index.php.</p>
<p>But the Index Templates are only half of the problem. There are a lot of other files generated by MT: the pages for individual entries, for example. These share a common template — it's under the &quot;Archives&quot; tab in the templates section. But if you click to it, you'll find that there's no place to specify the extension.</p>
<p>Instead, click on &quot;Settings&quot; in the left sidebar, then on the &quot;Publishing&quot; tab. You'll see a screen like this:</p>
<p><a class="reference external image-reference" href="http://www.flickr.com/photo_zoom.gne?id=370935654&amp;size=o"><img alt="changing movable type's archive template extension" class="center" src="http://farm1.static.flickr.com/138/370935654_8110dea79a.jpg" /></a></p>
<p>Again, note the yellow box, change its contents from &quot;html&quot; to &quot;php&quot; and hit &quot;Save Changes&quot;.</p>
<p><img alt="Movable Type's 'Rebuild' Button" class="right" src="/static/2007/01/27/2000127_mtrebuilt.gif" />You're almost done with the HTML » PHP conversion. Click on the &quot;Rebuild Site&quot; button in the left sidebar, select &quot;Rebuild All Files&quot; from the dropdown and click the &quot;Rebuild&quot; button. Depending on the size of your site, this might take a little while.</p>
<p>Okay. What Movable Type has just done is regenerated every file on your site as a .php file. But there's a problem: the .html files are still there. It's not a <em>big</em> problem — the links that are generated by MT to things like your archives and individual entries will all have been changed automatically. But incoming links to old entries will be pointing at the .html file, which is no longer the right thing for them to point to. Fortunately, we can fix this. Open up Notepad or another text editor and enter this text:</p>
<blockquote>
<pre class="literal-block">
# This file automatically sends users looking for .html files to the
# equivalent .php file, if it exists.  It should be named .htaccess and placed
# in the directory that corresponds to the root of your website.
&lt;IfModule mod_rewrite.c&gt;
# turn on the rewriting engine
RewriteEngine on
# make this equivalent to the part that comes after your
# domain name.  for example, if your blog lives at
# http://www.server.com/my/blog, make the next line read
# RewriteBase /my/blog
RewriteBase   /
# parse out basename, but remember if we did
RewriteRule   ^(.*)\.html$              $1      [NC,E=WasHTM:yes]
# rewrite to document.php if exists
RewriteCond   %{REQUEST_FILENAME}.php -f
RewriteRule   ^(.*)$ $1.php             [R=301,S=1]
# else reverse the previous removal of .html
RewriteCond   %{ENV:WasHTM}            ^yes$
RewriteRule   ^(.*)$ $1.html
&lt;/IfModule&gt;
# adapted from http://www.totalchoicehosting.com/forums/lofiversion/index.php/t25151.html
</pre>
</blockquote>
<p>Be sure you edit the line with &quot;RewriteBase&quot; in it if your blog lives in a subdirectory of your website (if it lives at the domain's root — e.g. <a class="reference external" href="http://www.manifestdensity.net">http://www.manifestdensity.net</a> instead of <a class="reference external" href="http://www.zunta.org/blog">http://www.zunta.org/blog</a> — then you can leave it alone). Save this as a file called &quot;htaccess&quot;. Using an FTP client, upload it to the root public directory of your website — the directory which, if I uploaded a file called test.txt to it, would result in the file being available at /static/2007/01/27/test.txt (it's frequently the directory called &quot;public_html&quot; that you see as soon as you connect with FTP). Then, still using the FTP client, rename it to &quot;<strong>.</strong>htaccess&quot; (we're adding the dot at this point because on some systems adding it earlier would have made it invisible, and consequently quite a bit harder to work with). If an .htaccess file already existed, you probably shouldn't overwrite it. Email me the contents and we can sort through how to merge the two.</p>
<p>If your webserver is configured in a typical way, this .htaccess file will make the server look at every incoming request for a file ending in .html and check to see if there's an identically-named file ending in .php. If there is, it'll forward the user to the .php version. If there isn't, it'll serve up the original .html. Handy, huh? Have a look around your site (and via old links to it on other sites) and make sure that everything is working the way you expect it to.</p>
<p>Okay. It's taken us a while to get here, I admit. But things should get easier from here on out. You now have the ability to put PHP in your templates in order to generate obfuscated Javascript that will in turn obfuscate the comment script's location. The first thing to do is to change the comment script's name — after all, if the spammers already know its location, hiding that location won't do us much good.</p>
<p>Fire up your FTP client again and go to the directory where MT is installed. Use it to rename mt-comments.cgi to something hard to guess — for the purposes of this post, I'll pretend you chose <em>toms-replacement-mt-comments.cgi</em>, but you should select something unique and hard to guess. From the same directory, download <em>mt-config.cgi</em> and open it up in a text editor. Look for a line like this:</p>
<blockquote>
<pre class="literal-block">
CommentScript mt-comments.cgi
</pre>
</blockquote>
<div class="line-block">
<div class="line">If there is one, change <em>mt-comments.cgi</em> to</div>
<div class="line"><em>toms-replacement-mt-comments.cgi</em>. If there isn't one, add one:</div>
</div>
<blockquote>
<pre class="literal-block">
CommentScript toms-replacement-mt-comments.cgi
</pre>
</blockquote>
<p>Save the file and upload it over your old mt-config.cgi.</p>
<p>Congratulations: your comments are now broken! This is because all the comment forms on your site are now pointing at the script's old name. If you rebuilt the site they'd be automatically fixed (assuming your templates are properly written), since MT would swap in the new script name. But we don't want to do that just yet.</p>
<p>Instead, go into your MT Admin Panel's Templates section again. Go to the Archives tab and open the Individual Entry Archive template. Find the opening &lt;form&gt; tag for the comment form — in the default MT 3.2 templates, it looks like this:</p>
<blockquote>
<pre class="literal-block">
&lt;form method=&quot;post&quot; action=&quot;&lt;$MTCGIPath$&gt;&lt;$MTCommentScript$&gt;&quot; name=&quot;comments_form&quot; onsubmit=&quot;if (this.bakecookie.checked) rememberMe(this)&quot;&gt;
</pre>
</blockquote>
<p>Notice the action=&quot;&lt;$MTCGIPath$&gt;&lt;$MTCommentScript$&gt;&quot; line. This is what we're going to change, so that instead it's set by Javascript. In order to do that, we need to know how to manipulate the form in Javascript. As in the Bible/Hellboy comics, naming a thing gives you power over it: make sure that the <strong>name=&quot;comments_form&quot;</strong> portion of the &lt;form&gt; tag is present in your comment form (if <strong>name</strong> is there but set to something else, change the Javascript I've provided to use that name instead of <strong>comments_form</strong>).</p>
<p>Alright. Almost there. First, we need to point the form's action attribute at the wrong place, to lead spammers on a wild goose chase. That's easy enough to do — setting <strong>action=&quot;/&quot;</strong> should be sufficient. Now let's use some Javascript to set the form's action to the right thing. Right after the form's closing tag, add the following Javascript (I've included the &lt;form&gt; tag, too, to remind you where it goes. Don't paste this in as well — you only need one &lt;form&gt; tag.).</p>
<blockquote>
<pre class="literal-block">
&lt;form method=&quot;post&quot; action=&quot;/&quot; name=&quot;comments_form&quot; onsubmit=&quot;if (this.bakecookie.checked) rememberMe(this)&quot;&gt;
All of the form's HTML
&lt;/form&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
document.comments_form.action = '&lt;$MTCGIPath$&gt;&lt;$MTCommentScript$&gt;';
&lt;/script&gt;
</pre>
</blockquote>
<p>There! Your form's action is now somewhat hidden. If you'd like to hide it further (and make use of our exciting new PHP powers), just paste in the function that I wrote yesterday and use it to scramble the JS. It should end up looking like so:</p>
<blockquote>
<pre class="literal-block">
&lt;form method=&quot;post&quot; action=&quot;/&quot; name=&quot;comments_form&quot; onsubmit=&quot;if (this.bakecookie.checked) rememberMe(this)&quot;&gt;
All of the form's HTML
&lt;/form&gt;
&lt;?php
function ObfuscateJS($string_to_obfuscate, $number_of_variables=5, $max_chars_per_chunk=3)
{
// create some random variables that will be used by JS later on
$vars = array();
for($i=0;$i&lt;$number_of_variables;$i++)
$vars[] = rand();
// begin building the JS string
$js = &quot;if(typeof(Obfuscator)!='object')\n   var Obfuscator = new Object();\n&quot;;
for($i=0;$i&lt;sizeof($vars);$i++)
$js .= &quot;Obfuscator.v$i = &quot; . $vars[$i] . &quot;;\n&quot;;
$js .= &quot;eval(''&quot;;
while(strlen($string_to_obfuscate))
{
// figure out how many characters we're going to encode this time
$num_chars_this_time = rand(1,$max_chars_per_chunk);
// grab that chunk of characters
$this_chunk = str_replace(&quot;'&quot;,&quot;\\'&quot;,substr($string_to_obfuscate,0,$num_chars_this_time));
// remove that chunk from the string we're working on
$string_to_obfuscate = substr($string_to_obfuscate,$num_chars_this_time);
// create a plausible-seeming alternate, garbage chunk
$rotated_chunk = '';
for($i=0;$i&lt;strlen($this_chunk);$i++)
{
$thischar = substr($this_chunk,$i,1);
if((($thischar&gt;='A')&amp;&amp;($thischar&lt;='Z'))||(($thischar&gt;='a')&amp;&amp;($thischar&lt;='z')))
$thischar = chr(ord($thischar) + (((rand()%2)==1) ? 1 : -1));
$rotated_chunk .= $thischar;
}
// figure out which of our random variables we're going to use
$v1index = rand(0,sizeof($vars)-1);
$v2index = rand(0,sizeof($vars)-1);
// write out a short-form JS if-then that uses the random vars to decide its order
$js .= &quot; + ((Obfuscator.v$v1index &gt; Obfuscator.v$v2index) ? &quot; . (($vars[$v1index]&gt;$vars[$v2index]) ? &quot;'$this_chunk' : '$rotated_chunk')&quot; : &quot;'$rotated_chunk' : '$this_chunk')&quot;);
}
$js .= &quot;);\n&quot;;
return $js;
}
?&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
&lt;?php print ObfuscateJS(&quot;document.comments_form.action = '&lt;$MTCGIPath$&gt;&lt;$MTCommentScript$&gt;';&quot;);?&gt;
&lt;/script&gt;
</pre>
</blockquote>
<p>That's it! Well, okay, almost it: you'll have to make the same changes on any other templates where a comment form appears. [STRIKEOUT:The comment preview template springs to mind] (see update). If you have comment forms in any other places on your site, you'll have to hunt those down, too. But that shouldn't be too hard. Once you're done, rebuild your site again, verify that comments are working, and revel in your now somewhat-better-protected comment system.</p>
<p>Next: a way to rename <em>mt-comments.cgi</em> on an hourly basis. That'll show 'em.</p>
<p><strong>UPDATE:</strong> Forget what I said about the comment preview template needing to be changed in a similar way. What you should actually do is <strong>remove the action property entirely from the comment preview template's &lt;form&gt; tag</strong>. I explain why in <a class="reference external" href="/2007/01/26/fighting-movable-type-comment-spam-part-1/">part 3</a> which — hey! — is now available. How about that.</p>

                </div>
            </article>
        </div>
    </div>

    <!-- Archive by Year Section -->

</div>
    </div>

    <footer id="typology-footer" class="typology-footer">
        <div class="container">
            <div class="footer-content">
                <p>&copy;  Tom Lee</p>
                <!-- <p>Powered by <a href="https://getpelican.com/" target="_blank" rel="noopener">Pelican</a></p> -->
            </div>
        </div>
    </footer>
</body>
</html>