<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>music, tech - Tom Lee</title>


    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Domine:wght@400;600;700&family=Josefin+Sans:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Theme CSS -->
    <link rel="stylesheet" href="/theme/css/style.css">

    <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Tom Lee Atom Feed" />

</head>

<body>
    <header id="typology-header" class="typology-header">
        <div class="container">
            <div class="header-content">
                <div class="site-branding">
                    <h1 class="site-title"><a href="/">Tom Lee</a></h1>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li><a href="/">Home</a></li>
                        <li><a href="/about/">About</a></li>
                        <li><a href="/projects/">Projects</a></li>
                        <li class="social-icon"><a href="https://github.com/sbma44" target="_blank" rel="noopener" title="GitHub" aria-label="GitHub">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                        </a></li>
                        <li class="social-icon"><a href="https://x.com/tjl" target="_blank" rel="noopener" title="Twitter" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg>
                        </a></li>
                        <li class="social-icon"><a href="https://bsky.app/profile/tjl.bsky.social" target="_blank" rel="noopener" title="Bluesky" aria-label="Bluesky">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"/></svg>
                        </a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <div class="typology-fake-bg">
<div class="typology-section">
    <div class="section-head">
        <h1 class="section-title">music, tech</h1>
    </div>
    
    <div class="section-content">
        <div class="typology-posts">
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2009/03/30/woxy-growl-notifications/">WOXY Growl notifications</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2009-03-30T11:26:00-04:00">Monday, 30 March 2009</time>
                        </span>
                    </div>
                    <div class="post-letter">W</div>
                </header>
                
                <div class="entry-content">
                    <p>A while ago I pestered the author of the <a class="reference external" href="http://www.uhlenbrock.us/woxy/">WOXY playlist widget</a> to add Growl support — I like to be able to learn what I'm listening to without opening my web browser — and he was nice enough to do so. That worked okay for a while, but I think the widget's no longer being maintained; at the very least my copy now seems to be broken.</p>
<p>But two things have changed, making the kludginess of a widget unnecessary. First, a few months ago <a class="reference external" href="http://woxy.com/stream/mpg128.pls">WOXY began offering a 128kbps MP3 stream</a>, providing listenable sound quality without the use of their iTunes-unfriendly AACPlus stream. Second, it appears that last month <a class="reference external" href="http://www.dolejsky.com/2009/02/19/growltunes-patch/">some nice fellow on the internet</a> patched the GrowlTunes helper app so that it actually shows notifications properly when there's a track change in a radio stream being played by iTunes. Thanks, stranger!</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2008/10/07/all-you-wanna-do-is-street-fight/">all you wanna do is street fight</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2008-10-07T16:51:00-04:00">Tuesday, 07 October 2008</time>
                        </span>
                    </div>
                    <div class="post-letter">A</div>
                </header>
                
                <div class="entry-content">
                    <p>I only mentioned Man Factory's Street Fighter concept album <a class="reference external" href="http://www.manifestdensity.net/2008/09/15/music_at_least_some_of_which_i/">in passing</a> at first, but having given it some more attention (and having done so at Ezra's recommendation), I feel like I should push it a little harder: it's pretty clever and catchy, and is really more of a straight-up rock opera than a mere concept album. Its brevity left me a bit confused at first, but I now see that this is just the first of <a class="reference external" href="http://blogs.dallasobserver.com/dc9/2008/06/man_factory_talks_street_fight.php">three planned &quot;rounds&quot;</a>.</p>
<p>It's a <a class="reference external" href="http://students.uta.edu/tm/tmw7914/roundone.zip">free download</a> — what have you got to lose?</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2008/03/27/muxtape-unraveled/">Muxtape unraveled</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2008-03-27T21:31:00-04:00">Thursday, 27 March 2008</time>
                        </span>
                    </div>
                    <div class="post-letter">M</div>
                </header>
                
                <div class="entry-content">
                    <p>I've seen a lot of attention paid to <a class="reference external" href="http://www.muxtape.com">Muxtape</a> over the past few days, and I agree: it's nice! I think a lot of the romanticism that people attach to the mixtape format is silly, and that removing portability from the equation makes it a lot less useful. But Muxtape is clean and built around an attractively simple idea.</p>
<p>I will say, though, that it does even less than usual to prevent the files it stores from being downloaded. If you fire up Firebug after you start a song playing, it's easy enough to find the Flash player, which is being passed a set of parameters that look like this:</p>
<blockquote>
type=mp3&amp;width=0&amp;height=0&amp;file=http%3A//muxtape.s3.amazonaws.com/songs/abcdefg94fb3f63d668bbc521b8eb3460%3FPLEASE%3DDO_NOT_STEAL_MUSIC%26AWSAccessKeyId%3D1R7VFFT45XS0N28M1K02%26Expires%3D1206670309%26Signature%3Dl8pKlxHGgz2LdSomiK38sA%252Fp7EM%253D&amp;javascriptid=playeraa5bd894fb3f63d668bbc521b8eb3460&amp;enablejs=true</blockquote>
<p>If you pull out the <em>file</em> parameter and decode it, it looks like this:</p>
<blockquote>
<a class="reference external" href="http://muxtape.s3.amazonaws.com/songs/abcdefg94fb3f63d668bbc521b8eb3460?PLEASE=DO_NOT_STEAL_MUSIC">http://muxtape.s3.amazonaws.com/songs/abcdefg94fb3f63d668bbc521b8eb3460?PLEASE=DO_NOT_STEAL_MUSIC</a></blockquote>
<p>Yes, really. I've changed enough of the URL to make it invalid, but still: asking is probably not going to be enough.</p>
<p>I'll admit that this is a hard problem to solve. Unless you're prepared to undertake a major software development project whereby you decrypt your data client-side and send raw PCM to the sound card — and trust me, you're probably not — you're going to be stuck using Adobe Flash to play music in-browser. And if that's the case, you're pretty much stuck using a command that amounts to:</p>
<blockquote>
dear_flash_please_play_this_mp3('<a class="reference external" href="http://server.com/my-music-file.mp3">http://server.com/my-music-file.mp3</a>');</blockquote>
<p>This is not very secure — Flash needs to get that URL from somewhere, and if the user can figure it out they can download the file as easily as Flash can. All you can do at THAT point is hiding the name of the file by changing it so quickly that a user's browser can be bothered to figure it out, but the user herself cannot (this is what iMeem and MySpace do). You'll probably also insert some hoops that Flash has to jump through to prove its Flash-iness, all of which can be easily faked but which will at least discourage casual downloading.</p>
<p>But the guy running Muxtape has screwed himself out of these measures by using Amazon S3 to store his files, which is handy and cheap but can't implement a system for changing filenames rapidly, or employ HTTP user agent filtering, or check for tokens, or really do any other server-side cleverness. So the only option he has left is simply asking people not to download. Which I admire, because all of these countermeasures, even the encryption, can be defeated. But I doubt the record companies are going to be as sanguine about it.</p>
<p>But who knows! Maybe he'll be able to figure out some sort of promotional detente the way the Hype Machine folks have. I hope so. But right now it will be pretty easy for someone to write a Greasemonkey script to allow direct downloading, or for music bloggers looking for free storage to hotlink the site to death.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2008/03/10/the-march-of-progress/">the march of progress</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2008-03-10T11:56:00-04:00">Monday, 10 March 2008</time>
                        </span>
                    </div>
                    <div class="post-letter">T</div>
                </header>
                
                <div class="entry-content">
                    <p><a class="reference external" href="http://tinyurl.com/yt7ynq">Looks like</a> someone took <a class="reference external" href="http://tinyurl.com/24k82j">my work</a> as a starting point and make a <a class="reference external" href="http://userscripts.org/scripts/show/23612">hy/pe m Greasemonkey script</a>. It's nice! I wrote an equivalent bookmarklet right after I wrote that post but didn't distribute it. It wasn't as nice as this Greasemonkey script, either — check out the fancy data-URI-encoded icons on this guy! Anyway, get (and use) it now before they rotate encryption keys and break both of em.</p>
<p>It seems slightly silly to me that the free music sampling position we've arrived at is so delicate and tendentious. Everyone's fiercely guarding their bandwidth and ability to deny liability while tacitly admitting the underlying truth: single tracks are now essentially free, priced only by the amount of inconvenience it takes to obtain them — which is primarily a function of which startup has how much remaining money/lawsuits pending against them. It's all pretty dumb.</p>
<p>A suggestion for the idle Flash developers that I'd like to believe are reading this but probably aren't: how about a <a class="reference external" href="http://blog.delicious.com/blog/2005/11/we_rock_part_2.html">PlayTagger</a>-like application with the following capabilities:</p>
<ol class="arabic simple">
<li>The ability to take a semicolon-delimited list of URLs for an mp3 link (in the <em>rel</em> attribute or similar) and randomly serve one so as to balance load and bandwidth costs.</li>
<li>HTTP_REFERER header forging; either automatic (root of serving domain) or user-specified.</li>
<li>The ability to scrape HTML pages included in that <em>rel</em> list of URLs and find matching mp3 links based on filename or link text comparison.</li>
<li>Testing links for 404s/30xs; on error, proceed to the next URL specified.</li>
</ol>
<p>It should all be pretty simple stuff, except perhaps for the second and last item — I'm not sure how sophisticated ActionScript's HTTP functionality is. And it'd allow linking to mp3 files in a way that's unlikely to break, unlikely to bankrupt the people hosting the files, and that could be automatically generated without too much trouble.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2008/01/08/the-denials-get-weaker/">the denials get weaker</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2008-01-08T10:33:00-05:00">Tuesday, 08 January 2008</time>
                        </span>
                    </div>
                    <div class="post-letter">T</div>
                </header>
                
                <div class="entry-content">
                    <p><a class="reference external" href="http://juliansanchez.com/notes/archives/2008/01/the_music_today_is_nuthin_but.php">Julian's</a> just linked to a <a class="reference external" href="http://www.rollingstone.com/news/story/17777619/the_death_of_high_fidelity/print">pretty good article about audio compression</a> from Rolling Stone. I'd also recommend <a class="reference external" href="http://spectrum.ieee.org/aug07/5429">this IEEE Spectrum article</a> on the subject. I suggest you choose according to who you consider more culpable: the geeks who engineer the offending waveform compressors, or the sold-out music journalists who help create a market for them.</p>
<p>But I wonder how much longer this will be a problem. The cost to keeping an alternate version of a digital file in inventory is just about zero. And consider that radio-ready crossover tracks are already commonly mixed into different forms for different broadcast outlets: adult contemporary stations get the acoustic guitar cranked up, and stations with &quot;Z&quot; in their names may be treated to an extra bass line (the better to make their listeners' rusted-out hatchbacks buzz, rattle and hum).</p>
<p>I'll admit I'm not an expert on the mixing and mastering process — Charles, maybe you can chime in? — but my impression is that compressing the hell out of a song requires considerably less work than mixing those alternate versions. So if you can get just a few hundred people to buy the crisp, uncompressed FLAC version of a song, I imagine that'd pay for its production costs. It's actually the audiophiles who are holding this back: their disdain for portable players and digital files is preventing support for the lossless FLAC format from hitting the market (<a class="reference external" href="http://flac.sourceforge.net/links.html#hardware">some players support it, of course</a>, but not many).</p>
<p>Incidentally, this all ties pretty well into something I've been pondering lately. Since the demise of Oink I've found myself listening to a lot of 128kbps or lower MP3s — the Hype Machine transcodes everything to that bitrate, and WOXY's 32kbps AACPlus stream, while somewhat of an apple to MP3's orange, is certainly less than perfect sounding. And it's true that I've been feeling a little less emotional impact from many of the songs. It sounds stupid, I know. This didn't happen to me in the past.</p>
<p>But I think this is partly just the result of getting older, and it's given me an important perspective on audiophile pretension. The market for high-end equipment is defined by the rich old guys who can afford to buy it — folks whose high-frequency-sensitive cochlear hair cells have given up the ghost in significant numbers. So one should expect that audiophile gear will be tuned to overcome these deficiencies. It'll seem both extravagantly stupid and stupidly extravagant to the still-immortal young'uns, but decreasingly so as their own ears age — different age groups effectively have different equalizers built into their heads. It's worth keeping in mind that a hunger for ludicrously expensive speakers may be as much a sign of a medical condition as it is a sign of having too much money. Happily, the cure for both afflictions is the same.</p>
<p>(None of the preceding should be taken to mean that anyone buying <a class="reference external" href="http://www.machinadynamica.com/machina31.htm">this</a> is anything less than a complete moron.)</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/12/13/more-command-line-rock/">more command line rock</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-12-13T12:50:00-05:00">Thursday, 13 December 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">M</div>
                </header>
                
                <div class="entry-content">
                    <p>Recording for posterity, because recreating Perl one-liners is a pain in the ass. If you're on a *nix like system (including OS X), this will download all the MP3s linked from a given URL:</p>
<blockquote>
<pre class="literal-block">
curl -s http://somemusicblog.com/goodsongs.html | perl -nle 'print $1 while /\&lt;a\b[^\&gt;&quot;]*?\bhref=\&quot;?([^\&gt;&quot;]*)\.mp3/g' | xargs -I {} curl -O {}.mp3
</pre>
</blockquote>
<p><strong>UPDATE:</strong> <a class="reference external" href="http://earfarm.blogspot.com/2007/12/ear-farms-top-ten-bands-to-emerge-in.html">This URL</a> might be a good one to try it out on.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/11/26/lets-pick-on-a-different-mp3-aggregator-for-a-change/">let's pick on a different mp3 aggregator for a change</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-11-26T16:14:00-05:00">Monday, 26 November 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">L</div>
                </header>
                
                <div class="entry-content">
                    <p>The Hype Machine is great, but it's not the only one out there, after all. Besides, it's got certain shortcomings: its &quot;popular&quot; page is fine if you want to listen to a ton of Bloc Party, but can suffer from a lack of variation. And looking at the front page is like drinking from a firehose. The <a class="reference external" href="/2007/11/23/everything-is-connected/">podcast feed that I made last week</a> suffers for it: you're not getting a representative snapshot of what's being talked about, but rather just a random sampling of what was popular when your copy of iTunes decided to check in. And, as I mentioned, the feed will no doubt be shut down by the HM guys (they may have already throttled iTunes' bandwidth).</p>
<p>So what about elbo.ws? They publish a <a class="reference external" href="http://elbo.ws/tracks">daily-updated list of popular tracks</a> that contains more music I haven't heard. And it's persistent enough that querying it once a day could be useful. The only problem is that it doesn't carry any MP3 links: users have to go hunting at the linked blogs to find links that are still alive. This makes it kind of a pain in the ass to check out the referenced music (and is why I generally prefer the Hype Machine).</p>
<p>But it <em>is</em> possible to create a podcast feed using techniques similar to the ones I applied to the Hype Machine. <a class="reference external" href="http://pipes.yahoo.com/sbma44/elbowspodcast">Here's</a> a pipe that simply retrieves the elbo.ws top tracks feed (or any other elbo.ws feed — it just defaults to that) and adds an enclosure tag to each entry. That tag tells iTunes (or whatever) to come talk to my server, passing the link associated with the elbo.ws entry.</p>
<p>At the server the request is intercepted via an .htaccess rewrite rule and redirected to a script (iTunes insists on URLs ending in .mp3, otherwise this would be unnecessary). The script pulls up the elbo.ws page and grabs the song name and listed blogs. It then loads the blogs and pulls out all of the MP3 links. From there it compares the link text to the collected song name and orders the results by similarity scores. Then it attempts to load each URL. For the first working one it finds it sends a redirect message to iTunes.</p>
<p>All this text processing and page-loading is pretty computationally expensive — it generally takes about half a minute to find a match — but with some caching it my server shouldn't be <em>completely</em> destroyed. An occasional incorrect match is returned, but overall I'm pretty pleased with the thing.</p>
<p>Here's the code for anyone interested. Given that this doesn't affect the elbo.ws folks' bandwidth or liability, I'm assuming they won't mind:</p>
<blockquote>
<pre class="literal-block">
&lt;?php
// taken from http://www.php.net/manual/en/function.file-exists.php#79118
function url_exists($url)
{
$handle   = curl_init($url);
if (false === $handle)
{
return false;
}
curl_setopt($handle, CURLOPT_HEADER, false);
curl_setopt($handle, CURLOPT_FAILONERROR, true);
curl_setopt($handle, CURLOPT_NOBODY, true);
curl_setopt($handle, CURLOPT_RETURNTRANSFER, false);
$connectable = curl_exec($handle);
curl_close($handle);
return $connectable;
}
function get_url($location)
{
$ch = curl_init($location);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Connection: close'));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_TIMEOUT, 15);
$response = curl_exec($ch);
curl_close($ch);
return $response;
}
function usort_by_similarity($a,$b)
{
if($a['similarity']==$b['similarity'])
return 0;
else
return (($a['similarity']&gt;$b['similarity']) ? 1 : -1);
}
function get_mp3_link_uncached($elbows_url)
{
$blog_matches = array();
$elbows_page_id = preg_replace('/^.*#/','',$elbows_url);
$elbows_page_html = get_url($elbows_url);
$blog_links = array();
if(preg_match_all('/&lt;ul[^&gt;]*&gt;.*?&lt;\/ul&gt;/i',$elbows_page_html,$elbows_page_unordered_lists,PREG_SET_ORDER))
{
$matching_ul_html = '';
foreach($elbows_page_unordered_lists as $match)
{
if(stristr($match[0],$elbows_page_id))
$matching_ul_html .= $match[0];
}
preg_match_all('/href=[\'&quot;](.*?)[\'&quot;]/',$matching_ul_html,$blog_matches,PREG_SET_ORDER);
$song_name = $elbows_page_id;
if(preg_match_all('/&lt;h3[^&gt;]*&gt;(.*?)&lt;\/h3&gt;/',$elbows_page_html,$song_name_matches,PREG_SET_ORDER))
$song_name = $song_name_matches[0][1];
}
$matches_for_analysis = array();
foreach($blog_matches as $match)
{
// find all mp3 links on the blog page
$html = get_url($match[1]);
if(preg_match_all('/&lt;a[^&gt;]+href=[\'&quot;]([^\'&quot;]*?\.mp3)[\'&quot;][^&gt;]*&gt;(.*?)&lt;\s*\/a\s*&gt;/i',$html,$mp3_matches,PREG_SET_ORDER))
{
// retrieve the one with the most similar inner text and store it for more processing
$current_best_match = null;
foreach($mp3_matches as $mp3_match)
{
$l_similarity = levenshtein(substr($mp3_match[2],0,255), substr($song_name,0,255));
if((!is_array($current_best_match))||($current_best_match['similarity']&gt;$l_similarity))
{
$current_best_match = array(
'url' =&gt; $mp3_match[1],
'text' =&gt; $mp3_match[2],
'similarity' =&gt; $l_similarity,
);
}
}
if($current_best_match!=null)
{
$matches_for_analysis[] = array(
'url' =&gt; $current_best_match['url'],
'text' =&gt; $current_best_match['text'],
'similarity' =&gt; $current_best_match['similarity'],
);
}
}
}
// sort the matches list from all blogs to find the one with the most similar title
usort($matches_for_analysis,'usort_by_similarity');
for($i=0;$i&lt;sizeof($matches_for_analysis);$i++)
if(url_exists($matches_for_analysis[$i]['url']))
return $matches_for_analysis[$i]['url'];
}
if(isset($_GET['url']))
{
ini_set('max_execution_time',999999);
ini_set('include_path','.:/usr/lib/php:/usr/local/lib/php:/include:/home/metamon/php');
require_once('Cache/Function.php');
define('CACHE_EXPIRATION_IN_SECONDS',900);
$fcache = new Cache_Function('file', array('cache_dir' =&gt; './cache', 'filename_prefix' =&gt; 'fcache_elbows_'), CACHE_EXPIRATION_IN_SECONDS);
$mp3_url = $fcache-&gt;call('get_mp3_link_uncached',urldecode($_GET['url']));
header(&quot;HTTP/1.1 301 Moved Permanently&quot;);
header(&quot;Location: &quot; . $mp3_url);
exit();
}
?&gt;
</pre>
</blockquote>
<p>And the .htaccess looks like this:</p>
<blockquote>
<pre class="literal-block">
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine on
RewriteRule ^.*\.mp3(.*)$ index.php$1 [L,QSA]
&lt;/IfModule&gt;
</pre>
</blockquote>
<p>I should add that I know none of this is new or mindblowing — projects like <a class="reference external" href="http://www.songbirdnest.com/">Songbird</a> are designed for exactly this sort of thing. But I like having my iPod automatically sync from one place, and I wanted to get at the elbo.ws feed specifically. Plus, y'know, it was fun to figure this out — it certainly taught me some things about the limits of Yahoo Pipes' JSON functionality.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/11/23/everything-is-connected/">everything is connected</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-11-23T13:26:00-05:00">Friday, 23 November 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">E</div>
                </header>
                
                <div class="entry-content">
                    <ol class="arabic simple">
<li><a class="reference external" href="http://noref.biz/?r=http%3A%2F%2Fblog.hypem.com%2F%3Fp%3D108">As noted on their blog</a>, some guy (not me; I wish I'd thought of it, although I wouldn't have published the MP3 URLs publicly) has written a script that pulls RSS from the HM, adds Last.fm popular tags to songs, and posts the MP3s' URLs to del.icio.us. The <a class="reference external" href="http://del.icio.us/taggedhype/indie_rock">result</a> is a huge, well-categorized stream of MP3s that represents most of the music blogosphere.</li>
<li>As you probably know, it's easy to filter a del.icio.us user's entries by tag — for instance, <a class="reference external" href="http://del.icio.us/taggedhype/indie_rock">here</a> are the HM entries tagged &quot;indie_rock&quot; (I should point out that the tags get considerably more granular than this example). Thanks to del.icio.us's cool <a class="reference external" href="http://del.icio.us/help/playtagger">PlayTagger</a> Flash audio player, this is already pretty useful. But it gets better.</li>
<li>It's also very easy to get an RSS feed of <a class="reference external" href="http://del.icio.us/rss/taggedhype">all</a> or <a class="reference external" href="http://del.icio.us/rss/taggedhype/indie_rock">part</a> of a del.icio.us user's entries.</li>
<li>It's only slightly harder to use Yahoo Pipes to turn an RSS feed of links to MP3s into an iTunes-compatible podcast feed. <a class="reference external" href="http://pipes.yahoo.com/pipes/pipe.info?_id=_jSmNvCZ3BGZCNZWYEsBXw">Here's a pipe</a> that lets you do exactly that to any given feed of MP3s.</li>
<li>Add this up and you get an ipod-ready podcast version of the HM. This is a feature that the site used to offer but no longer does (I could never get it working, anyway, although I think this was probably due to PC iTunes' suckiness at the time).</li>
</ol>
<p>Incidentally, they also have a new flash MP3 player over there, which is very nicely done. It's based on <a class="reference external" href="http://www.jeroenwijering.com/?item=jw_mp3_player">this guy's</a> MP3 player — I've used his Flash video player on a project at work and can attest to its awesomeness (javascript bindings!). It's free for personal use, too, and cheap for commercial applications.</p>
<p><strong>UPDATE:</strong> I should add that if you decide to try this out you should absolutely not set iTunes to update more often than once a day, as you'll be getting too much music to listen to and burning through HM's bandwidth for no good reason. Also, I should warn that the HM folks will probably shut this approach down shortly by disallowing iTunes' HTTP user agent string. I wish they'd just run the feed themselves, sticking advertising in the podcast entries to pay for the bandwidth. But it's probably pretty complicated to sell that particular kind of ad unit, so I'm not holding my breath waiting for it to happen.</p>
<p>Incidentally, this is yet another app that makes me wish Amazon's S3 storage service was free. That's a bit unrealistic, of course. But I'm increasingly convinced that we need an open P2P storage system. Something like <a class="reference external" href="http://wua.la/en/what.html">this</a> or an easier-to-use (and less porn-riddled) Freenet, but with a simple API. Ideally it'd be baked into some hugely-popular Firefox extension in order to garner sufficient levels of adoption.</p>
<p><strong>UPDATE 2:</strong> At a cursory glance <a class="reference external" href="http://oceanstore.cs.berkeley.edu/">Oceanstore</a> looks about right, although it seems as though it hasn't been worked on for a couple of years.</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/05/02/if-i-dont-write-properly-commented-code/">if I don't write (properly commented code)</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-05-02T15:55:00-04:00">Wednesday, 02 May 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">I</div>
                </header>
                
                <div class="entry-content">
                    <p><a class="reference external" href="http://www.travismorrison.com">Travis Morrison</a> <a class="reference external" href="http://www.stereogum.com/archives/005271.html">talks to Stereogum</a> about music, programming, and working for the Post. Interesting to see that he's a Javascript/ASP guy. I wonder if he's worked on anything with Adrian Holovaty (probably not, given their locations, departments and languages).</p>

                </div>
            </article>
            <article class="typology-post typology-layout-a">
                <header class="entry-header">
                    <h2 class="entry-title h1">
                        <a href="/2007/02/07/we-love-to-build/">we love to build</a>
                    </h2>
                    <div class="entry-meta">
                        <span class="meta-item">
                            <time datetime="2007-02-07T12:44:00-05:00">Wednesday, 07 February 2007</time>
                        </span>
                    </div>
                    <div class="post-letter">W</div>
                </header>
                
                <div class="entry-content">
                    <p>Holy crap. That Swimmers album is better than I'd expected — is it too early to start nominating candidates for Album of the Summer? The last few years' poor, belated crops of AoTSes makes me think that it'd best to get way out ahead of this thing. Anyway, you can listen to the whole album over at <a class="reference external" href="http://www.theswimmers.com/">their website</a>. I particularly like &quot;We Love To Build&quot; and &quot;St. Cecilia&quot;.</p>
<p>Relatedly, thanks to their use of the XSPF player the following super-nerdy* command is possible. I normally wouldn't post it, but I think it's the first time I ever actually got sed to do what I wanted.</p>
<blockquote>
<pre class="literal-block">
wget -q -O - http://theswimmers.com/player/playlist.xspf | sed -e '/annotation/d' -e '/playlist/d' -e '/track/d' -e '/encoding/d' -e 's/&lt;\/*location&gt;//g' | xargs wget
</pre>
</blockquote>
<p>A similar technique should be possible with the <a class="reference external" href="http://hype.non-standard.net">Hype Machine</a>, but their failure to use line breaks in their XSPF files makes the regex composition a bit harder, so I haven't bothered to figure it out yet.</p>
<p>* Admittedly, it's not even <em>close</em> to being as nerdy as <a class="reference external" href="http://stevenf.com/2007/01/zeppl_1.php">this</a>, which is awesome (via <a class="reference external" href="http://www.allthegooddomainsweretaken.com/">Miller</a>'s <a class="reference external" href="http://www.allthegooddomainsweretaken.com/">del.icio.us feed</a>).</p>

                </div>
            </article>
        </div>
    </div>
</div>
    </div>

    <footer id="typology-footer" class="typology-footer">
        <div class="container">
            <div class="footer-content">
                <p>&copy;  Tom Lee</p>
                <!-- <p>Powered by <a href="https://getpelican.com/" target="_blank" rel="noopener">Pelican</a></p> -->
            </div>
        </div>
    </footer>
</body>
</html>