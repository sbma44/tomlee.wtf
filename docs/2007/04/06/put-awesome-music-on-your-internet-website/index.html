<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>put awesome music on your internet website - Tom Lee</title>

    <meta name="description" content="It seems like everybody's been posting spring playlists: Kriston DCeiver The Governess Amanda Adrienne I did a little evangelizing for playtagger...">
    <meta name="robots" content="noindex, nofollow">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Domine:wght@400;600;700&family=Josefin+Sans:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Theme CSS -->
    <link rel="stylesheet" href="/theme/css/style.css">

    <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Tom Lee Atom Feed" />

</head>

<body>
    <header id="typology-header" class="typology-header">
        <div class="container">
            <div class="header-content">
                <div class="site-branding">
                    <h1 class="site-title"><a href="/">Tom Lee</a></h1>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li><a href="/">Home</a></li>
                        <li><a href="/about/">About</a></li>
                        <li><a href="/projects/">Projects</a></li>
                        <li class="social-icon"><a href="https://github.com/sbma44" target="_blank" rel="noopener" title="GitHub" aria-label="GitHub">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                        </a></li>
                        <li class="social-icon"><a href="https://x.com/tjl" target="_blank" rel="noopener" title="Twitter" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg>
                        </a></li>
                        <li class="social-icon"><a href="https://bsky.app/profile/tjl.bsky.social" target="_blank" rel="noopener" title="Bluesky" aria-label="Bluesky">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"/></svg>
                        </a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <div class="typology-fake-bg">
<div class="typology-section">
    <div class="section-content">
        <article class="typology-post typology-single-post">
            <header class="entry-header">
                <h1 class="entry-title">put awesome music on your internet website</h1>

                <div class="entry-meta">
                    <span class="meta-item">
                        <time datetime="2007-04-06T17:39:00-04:00">Friday, 06 April 2007</time>
                    </span>
                </div>

                <div class="post-letter">P</div>
            </header>

            <div class="entry-content">
                <p>It seems like everybody's been posting spring playlists:</p>
<ul class="simple">
<li><a class="reference external" href="http://grammarpolice.net/archives/001271.php">Kriston</a></li>
<li><a class="reference external" href="http://dceiver.blogspot.com/2007/04/march-top-20.html">DCeiver</a></li>
<li><a class="reference external" href="http://pygmalioninablanket.blogspot.com/2007/04/private-life-of-rat.html">The Governess</a></li>
<li><a class="reference external" href="http://blogstretch.blogspot.com/2007/03/playlist-im-fairly-certain-will-improve.html">Amanda</a></li>
<li><a class="reference external" href="http://www.clutchpearls.com/?p=720">Adrienne</a></li>
</ul>
<p>I did a little evangelizing for <a class="reference external" href="http://del.icio.us/help/playtagger">playtagger</a> over in Kriston's comments, and the PT bookmarklet I've got in my browser has made it easy enough to navigate through the mp3s that everyone's been linking to. But it occurred to me that folks might get some use out of an automatic flash player.</p>
<p>So! If you've got a webpage with a bunch of hyperlinks to mp3s and would like to add a nifty flash player to it, I've written up a handy tool to let you do just that. Simply put the permalink to your entry in the form field below and hit submit. That'll bring you to a page with some HTML. Copy that into your post and you'll have a player for all the mp3s you posted. Kinda neat, huh?</p>
<div class="docutils container">
<form action="http://www.metamonkey.net/easyxspf/" method="get"><table border="1" class="docutils">
<colgroup>
<col width="64%" />
<col width="36%" />
</colgroup>
<tbody valign="top">
<tr><td><p class="first">URL of page with MP3s</p>
<input type="checkbox" value="1" checked name="nocoral"><p class="last">&nbsp;Disable Coral?</p>
</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</form></div>
<p>A word about that &quot;disable coral&quot; option — since this loads the flash player off of my webserver, and since you may not be paying for the bandwidth used to stream those mp3s, the polite thing to do is to use the Coral CDN. However, it seems to be broken today (for me, at least), so I've left it disabled by default for the time being.</p>
<p>Here are some sample players that work with the pages above (Amanda and the Governess didn't post mp3s, and DCeiver was too polite to link directly to them, so no links for those guys):</p>
<ul class="simple">
<li><a class="reference external" href="http://www.metamonkey.net/easyxspf/?url=http%3A%2F%2Fgrammarpolice.net%2Farchives%2F001271.php&amp;nocoral=1&amp;html=2">Kriston</a></li>
<li><a class="reference external" href="http://www.metamonkey.net/easyxspf/?url=http%3A%2F%2Fwww.clutchpearls.com%2F%3Fp%3D720&amp;html=2&amp;nocoral=1">Adrienne</a></li>
<li>and, for good measure, <a class="reference external" href="http://www.metamonkey.net/easyxspf/?url=http%3A%2F%2Fwww.washingtonian.com%2Fblogarticles%2F3861.html&amp;nocoral=1&amp;html=2">Catherine's non-spring-specific but still useful-for-demonstration-purposes Washingtonian playlist</a></li>
</ul>
<p><strong>UPDATE (5/10/07):</strong> Thanks to some jerk hacking a piece of third party software on this site, this script has been unavailable for the past few weeks. It should be all better now.</p>
<p>If anyone's interested, the source code is available behind the jump.</p>
<p>It's pretty straightforward. All you really need to realize is that this script handles both the generation of the code for the user to embed, <em>and</em> the XSPF playlist itself.</p>
<blockquote>
<pre class="literal-block">
&lt;?php
if($_GET['html']&gt;0)
{
$url = $_GET['url'];
print &quot;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&quot;;
$markup = &quot;&lt;object classid=\&quot;clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\&quot;
codebase=\&quot;http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0\&quot;
width=\&quot;400\&quot; height=\&quot;168\&quot; &gt;
&lt;param name=\&quot;allowScriptAccess\&quot; value=\&quot;sameDomain\&quot;/&gt;
&lt;param name=\&quot;movie\&quot; value=\&quot;http://www.metamonkey.net&quot; . (($_GET['nocoral']==1) ? '' : '.nyud.net:8080') . &quot;/easyxspf/xspf_player.swf\&quot;/&gt;
&lt;param name=\&quot;quality\&quot; value=\&quot;high\&quot;/&gt;
&lt;param name=\&quot;bgcolor\&quot; value=\&quot;#E6E6E6\&quot;/&gt;
&lt;embed src=\&quot;http://www.metamonkey.net&quot; . (($_GET['nocoral']==1) ? '' : '.nyud.net:8080') . &quot;/easyxspf/xspf_player.swf?playlist_url=http://www.metamonkey.net/easyxspf/&quot; . str_replace('?','-QUERY-/',$url) . (($_GET['nocoral']==1) ? '/nocoral' : '') . &quot;\&quot;
quality=\&quot;high\&quot; bgcolor=\&quot;#E6E6E6\&quot; name=\&quot;xspf_player\&quot; allowscriptaccess=\&quot;sameDomain\&quot;
type=\&quot;application/x-shockwave-flash\&quot;
pluginspage=\&quot;http://www.macromedia.com/go/getflashplayer\&quot;
align=\&quot;center\&quot; height=\&quot;168\&quot; width=\&quot;400\&quot;&gt; &lt;/embed&gt;
&lt;/object&gt;&quot;;
if($_GET['html']==1)
{
print '&lt;pre&gt;' . str_replace('&lt;','&amp;lt;',str_replace('&gt;','&amp;gt;',$markup)) . '&lt;/pre&gt;';
print '&lt;p&gt;&lt;a href=&quot;http://www.metamonkey.net/easyxspf/?url=' . urlencode($url) . '&amp;html=2'. (($_GET['nocoral']==1) ? '&amp;nocoral=1' : '') . '&quot;&gt;I don\'t want HTML; show me the player&lt;/a&gt;&lt;/p&gt;';
}
else
{
print $markup;
print '&lt;p&gt;&lt;a href=&quot;http://www.metamonkey.net/easyxspf/?url=' . urlencode($url) . '&amp;html=1'. (($_GET['nocoral']==1) ? '&amp;nocoral=1' : '') . '&quot;&gt;I don\'t want the player; show me the HTML&lt;/a&gt;&lt;/p&gt;';
}
print &quot;&lt;/body&gt;&lt;/html&gt;&quot;;
}
else
{
set_include_path(get_include_path() . PATH_SEPARATOR . '/home/metamon/public_html/PEAR' . PATH_SEPARATOR . '/home/metamon/public_html/PEAR/PEAR');
require_once('PEAR/Cache.php');
require_once('PEAR/Cache/Function.php');
function CoralizeLink($link)
{
return preg_replace('/^http:\/\/([^\/]+)\/(.*)$/i','http://$1.nyud.net:8080/$2',$link);
}
function GetXSPF($url,$coralize)
{
$url = trim($url);
$domainprefix = preg_replace('/\/.*$/','',$url);
$coralizeddomainprefix = $domainprefix . '.nyud.net:8080';
$urlprefix = preg_replace('/\/[^\/]+$/','/',$url);
$html = file_get_contents($url);
preg_match_all('/&lt;a[^&gt;]+href=[\'&quot;](.*?\.mp3)[\'&quot;][^&gt;]*&gt;(.*?)&lt;\/a/i',$html,$matches,PREG_SET_ORDER);
print &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;
&lt;playlist version=\&quot;0\&quot; xmlns = \&quot;http://xspf.org/ns/0/\&quot;&gt;
&lt;trackList&gt;
&quot;;
foreach($matches as $match)
{
print &quot;   &lt;track&gt;
&lt;location&gt;&quot;;
if(preg_match('/^http:\/\//',$match[1]))
print ($coralize) ? CoralizeLink($match[1]) : $match[1];
else if(preg_match('/^\//',$match[1]))
print ($coralize) ? CoralizeLink($domainprefix . $match[1]) : ($domainprefix . $match[1]);
else
print ($coralize) ? CoralizeLink($urlprefix . $match[1]) : ($urlprefix . $match[1]);
print &quot;&lt;/location&gt;
&lt;annotation&gt;&quot; . preg_replace('/&lt;[^&gt;]*&gt;/','',$match[2]) . &quot;&lt;/annotation&gt;
&lt;/track&gt;
&quot;;
}
print &quot;   &lt;/track&gt;
&lt;/trackList&gt;
&lt;/playlist&gt;&quot;;
}
$url = urldecode($_GET['url']);
$coralize = true;
if(preg_match('/\/nocoral$/i',$url))
{
$coralize = false;
$url = preg_replace('/\/nocoral$/i','',$url);
}
$url = preg_replace('/\-QUERY\-\//','?',$url);
$fcache = new Cache_Function($container = 'file', array('cache_dir' =&gt; '/tmp', 'filename_prefix' =&gt; 'xspfplayer_cache_' ), 900);
//$fcache-&gt;call('GetXSPF',$url,$coralize);
GetXSPF($url,$coralize);
}
?&gt;
</pre>
</blockquote>
<p>You could strip out all of that PEAR function caching stuff if you wanted — it's just there to improve performance in case someone embeds a player and unexpectedly get an avalanche of traffic.</p>
<p>There is one complication, though. The URL of the playlist is passed in a querystring parameter to the XSPF player flash object. That's fine in most cases, but here the XSPF playlist <em>also</em> takes a querystring parameter. Making things worse, that parameter can also have its OWN querystring parameters (as in the case of Adrienne's Wordpress blog). Worst of all, the XSPF player doesn't handle URL-encoded strings very well. So we have to encode all of these parameters into a format that looks like a normal, parameter-less URL. It's a pain in the ass, but it can be done with an .htaccess file. Here's the one I'm using:</p>
<blockquote>
<pre class="literal-block">
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine on
# Rewrite current-style URLs of the form 'index.php?url=x'.
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?url=$1 [L,QSA]
&lt;/IfModule&gt;
</pre>
</blockquote>

            </div>

        </article>
    </div>
</div>
    </div>

    <footer id="typology-footer" class="typology-footer">
        <div class="container">
            <div class="footer-content">
                <p>&copy;  Tom Lee</p>
                <!-- <p>Powered by <a href="https://getpelican.com/" target="_blank" rel="noopener">Pelican</a></p> -->
            </div>
        </div>
    </footer>
</body>
</html>